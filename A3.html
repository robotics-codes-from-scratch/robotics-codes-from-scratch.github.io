<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Robotics codes from scratch (RCFS) is a collection of source codes to study and test learning and optimization problems in robotics through simple 2D examples." name="description"/>
  <meta content="robotics codes, robotics tutorial, rcfs, robotics from scratch" name="keywords"/>
  <meta content="Sylvain Calinon" name="author"/>
  <title>
   RCFS
  </title>
  <link href="static_images/favicon.ico" rel="icon" sizes="any"/>
  <link href="static_images/favicon.svg" rel="icon" type="image/svg+xml"/>
  <link href="css/bootstrap.min.css" rel="stylesheet"/>
  <link href="css/bootstrap-icons-1.10.4/font/bootstrap-icons.css" rel="stylesheet"/>
  <link href="css/permanent_marker.css" rel="stylesheet"/>
  <link href="css/main-template.css" rel="stylesheet"/>
  <link href="css/sidebars.css" rel="stylesheet"/>
  <link href="css/katex.min.css" rel="stylesheet"/>
  <script src="js/jquery-3.6.4.min.js">
  </script>
  <script src="js/bootstrap.bundle.min.js">
  </script>
  <script src="js/katex.min.js">
  </script>
  <script>
   function initialize(){
                convertMath();
                alignImages();
            }

            function convertMath(){
                const elements = document.getElementsByClassName("ltx_Math");
                const macros = {
				'\\tp': '\\text{\\tiny{#1}}',
				'\\trsp' : '\\top',
				'\\psin' : '\\dagger',
				'\\eqref': '\\href{###1}{(\\text{#1})}',
				'\\ref': '\\href{###1}{\\text{#1}}',
				'\\label': '\\htmlId{#1}{}'
			};
                for(let element of elements){
                    katex.render(element.textContent, element, {
                        throwOnError: false,
                        macros
                    });
                }
            }

            function alignImages(){

                document.getElementsByTagName('style').innerHTML = '';

                let txt_height = document.querySelector('#txt-col').offsetHeight;
                let img_height = document.querySelector('#img-col').offsetHeight;

                let margin = 50;

                if(txt_height > img_height && screen.width >= 576){
                    let nb_figures = document.querySelectorAll('.figure_main').length;
                    let computed_margin = (txt_height - img_height) / nb_figures;

                    if(computed_margin > margin){
                        margin = computed_margin;
                    }
                }

                const style = document.createElement('style');
                style.innerHTML = '.figure_main{ padding-top:'+Math.round(margin/2)+'px; padding-bottom:'+Math.round(margin/2)+'px; }';
                document.head.appendChild(style);
            }

            window.onload = initialize;
            window.onorientationchange = alignImages;
  </script>
 </head>
 <body>
  <nav aria-label="Light offcanvas navbar" class="navbar fixed-top" style="width: 50px;">
   <div class="container-fluid">
    <button aria-controls="offcanvasNavbarLight" class="navbar-toggler" data-bs-target="#offcanvasNavbarLight" data-bs-toggle="offcanvas" type="button">
     <span class="navbar-toggler-icon" style="cursor: pointer;">
     </span>
    </button>
    <div aria-labelledby="offcanvasNavbarLightLabel" class="offcanvas offcanvas-start" id="offcanvasNavbarLight" style="width: 500px;" tabindex="-1">
     <div class="offcanvas-header">
      <!--style='height: 50px;'-->
      <a class="navbar-brand" href="index.html">
       <h4 class="offcanvas-title" id="offcanvasNavbarLightLabel">
        <i class="bi bi-code-slash">
        </i>
        RCFS
       </h4>
      </a>
      <button aria-label="Close" class="btn-close" data-bs-dismiss="offcanvas" type="button">
      </button>
     </div>
     <div class="offcanvas-body">
      <!--Menu goes here-->
      <ul class="list-unstyled ps-0">
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="true" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#general-collapse" data-bs-toggle="collapse">
         General information
        </button>
        <div class="collapse show" id="general-collapse">
         <!--<li><a href='index.html' class='link-dark d-inline-flex text-decoration-none rounded'>Home</a></li>-->
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="about.html">
            <div class="p-1 mb-0">
             About
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="license.html">
            <div class="p-1 mb-0">
             License
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#sandboxes2d-collapse" data-bs-toggle="collapse">
         2D sandboxes
        </button>
        <div class="collapse" id="sandboxes2d-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_FK.html">
            <div class="p-1 mb-0">
             Forward kinematics (FK)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_IK.html">
            <div class="p-1 mb-0">
             Inverse kinematics (IK)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_bimanual.html">
            <div class="p-1 mb-0">
             Bimanual robot
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_humanoid.html">
            <div class="p-1 mb-0">
             Humanoid robot (CoM and coordination matrix)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_iLQR.html">
            <div class="p-1 mb-0">
             Iterative linear quadratic regulator (iLQR)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_iLQR_car.html">
            <div class="p-1 mb-0">
             iLQR for car
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_iLQR_bicopter.html">
            <div class="p-1 mb-0">
             iLQR for bicopter
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#sandboxes3d-collapse" data-bs-toggle="collapse">
         3D sandboxes
        </button>
        <div class="collapse" id="sandboxes3d-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox3d_IK.html">
            <div class="p-1 mb-0">
             Inverse kinematics (IK)
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#exercises-collapse" data-bs-toggle="collapse">
         Exercises
        </button>
        <div class="collapse" id="exercises-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise01.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             01
            </div>
            <div class="p-1 mb-0">
             Linear algebra in Python
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise02.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             02
            </div>
            <div class="p-1 mb-0">
             Movement primitives and Newton's method
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise03.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             03
            </div>
            <div class="p-1 mb-0">
             Gaussian Distributions
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise04a.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             4a
            </div>
            <div class="p-1 mb-0">
             Forward kinematics
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise04b.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             4b
            </div>
            <div class="p-1 mb-0">
             Inverse kinematics and nullspace control
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise05a.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             5a
            </div>
            <div class="p-1 mb-0">
             Forward dynamics
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise05b.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             5b
            </div>
            <div class="p-1 mb-0">
             Inverse dynamics and impedance control
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise06a.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             6a
            </div>
            <div class="p-1 mb-0">
             Planning with linear quadratic regulator
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise06b.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             6b
            </div>
            <div class="p-1 mb-0">
             Planning in joint space with LQR
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise07.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             07
            </div>
            <div class="p-1 mb-0">
             Iterative linear quadratic regulator (iLQR)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise08.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             08
            </div>
            <div class="p-1 mb-0">
             Exploration with ergodic control
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise09.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             09
            </div>
            <div class="p-1 mb-0">
             Orientation with Riemannian manifold
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#doc-collapse" data-bs-toggle="collapse">
         Online courses
        </button>
        <div class="collapse" id="doc-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small" id="menu_container">
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="toc.html" style="font-weight:bold;">
            Table of contents
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S1.html" style="font-weight:bold;">
            1 Introduction
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html" style="font-weight:bold;">
            2 Newton’s method for minimization
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html#sec:GaussNewton">
               <span class="p-1 mb-0">
                2.1 Gauss–Newton algorithm
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html#sec:LS">
               <span class="p-1 mb-0">
                2.2 Least squares
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html#sec:LSconstraints">
               <span class="p-1 mb-0">
                2.3 Least squares with constraints
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S3.html" style="font-weight:bold;">
            3 Forward kinematics (FK) for a planar robot manipulator
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S4.html" style="font-weight:bold;">
            4 Inverse kinematics (IK) for a planar robot manipulator
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S4.html#sec:IKnum">
               <span class="p-1 mb-0">
                4.1 Numerical estimation of the Jacobian
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S4.html#sec:IK_nullspace">
               <span class="p-1 mb-0">
                4.2 Inverse kinematics (IK) with task prioritization
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html" style="font-weight:bold;">
            5 Encoding with basis functions
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS1">
               <span class="p-1 mb-0">
                5.1 Univariate trajectories
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS2">
               <span class="p-1 mb-0">
                5.2 Multivariate trajectories
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS3">
               <span class="p-1 mb-0">
                5.3 Multidimensional inputs
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS4">
               <span class="p-1 mb-0">
                5.4 Derivatives
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS5">
               <span class="p-1 mb-0">
                5.5 Concatenated basis functions
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS6">
               <span class="p-1 mb-0">
                5.6 Batch computation of basis functions coefficients
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS7">
               <span class="p-1 mb-0">
                5.7 Recursive computation of basis functions coefficients
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html" style="font-weight:bold;">
            6 Linear quadratic tracking (LQT)
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#SS1">
               <span class="p-1 mb-0">
                6.1 LQT with smoothness cost
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#SS2">
               <span class="p-1 mb-0">
                6.2 LQT with control primitives
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:LQRrecursive">
               <span class="p-1 mb-0">
                6.3 LQR with a recursive formulation
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:augmState">
               <span class="p-1 mb-0">
                6.4 LQT with a recursive formulation and an augmented state space
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:LQRLS">
               <span class="p-1 mb-0">
                6.5 Least squares formulation of recursive LQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:DMPLQT">
               <span class="p-1 mb-0">
                6.6 Dynamical movement primitives (DMP) reformulated as LQT with control primitives
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html" style="font-weight:bold;">
            7 iLQR optimization
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#sec:iLQRbatch">
               <span class="p-1 mb-0">
                7.1 Batch formulation of iLQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#sec:iLQRrecursive">
               <span class="p-1 mb-0">
                7.2 Recursive formulation of iLQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#sec:iLQRLS">
               <span class="p-1 mb-0">
                7.3 Least squares formulation of recursive iLQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS4">
               <span class="p-1 mb-0">
                7.4 Updates by considering step sizes
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS5">
               <span class="p-1 mb-0">
                7.5 iLQR with quadratic cost on f(x_{t})
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS6">
               <span class="p-1 mb-0">
                7.6 iLQR with control primitives
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS7">
               <span class="p-1 mb-0">
                7.7 iLQR for spacetime optimization
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS8">
               <span class="p-1 mb-0">
                7.8 iLQR with offdiagonal elements in the precision matrix
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS9">
               <span class="p-1 mb-0">
                7.9 Car steering
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS10">
               <span class="p-1 mb-0">
                7.10 Bicopter
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S8.html" style="font-weight:bold;">
            8 Forward dynamics (FD) for a planar robot manipulator
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S8.html#SS1">
               <span class="p-1 mb-0">
                8.1 Robot manipulator with dynamics equation
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="bib.html" style="font-weight:bold;">
            References
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A1.html" style="font-weight:bold;">
            A System dynamics at trajectory level
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A2.html" style="font-weight:bold;">
            B Derivation of motion equation for a planar robot
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A3.html" style="font-weight:bold;">
            C Linear systems used in the bimanual tennis serve example
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A4.html" style="font-weight:bold;">
            D Equivalence between LQT and LQR with augmented state space
           </a>
          </li>
         </ul>
        </div>
       </li>
      </ul>
     </div>
    </div>
   </div>
  </nav>
  <div class="container-fluid">
   <!--<center><h1 class="title">My Title</h1></center>-->
   <div id="data_container">
    <div class="row">
     <div class="col-sm-7 offset-1">
      <div id="txt-col">
       <h1 class="ltx_title ltx_title_appendix">
        <span class="ltx_tag ltx_tag_appendix">
         Appendix C
        </span>
        Linear systems used in the bimanual tennis serve example
       </h1>
       <div class="ltx_para" id="p1">
        <p class="ltx_p">
         <span class="ltx_Math" id="p1.m1">
          \bm{x}
         </span>
         represents the state trajectory of 3 agents: the left hand, the right hand and the ball.
The nonzero elements correspond to the targets that the three agents must reach.
For Agent 3 (the ball),
         <span class="ltx_Math" id="p1.m2">
          \bm{\mu}
         </span>
         corresponds to a 2D position target at time
         <span class="ltx_Math" id="p1.m3">
          T
         </span>
         (ball target), with a corresponding 2D precision matrix (identity matrix) in
         <span class="ltx_Math" id="p1.m4">
          \bm{Q}
         </span>
         . For Agent 1 and 2 (the hands),
         <span class="ltx_Math" id="p1.m5">
          \bm{\mu}
         </span>
         corresponds to 2D position targets active from time
         <span class="ltx_Math" id="p1.m6">
          \frac{3T}{4}
         </span>
         to
         <span class="ltx_Math" id="p1.m7">
          T
         </span>
         (coming back to the initial pose and maintaining this pose), with corresponding 2D precision matrices (identity matrices) in
         <span class="ltx_Math" id="p1.m8">
          \bm{Q}
         </span>
         .
The constraint that Agents 2 and 3 collide at time
         <span class="ltx_Math" id="p1.m9">
          \frac{T}{2}
         </span>
         is ensured by setting
         <span class="ltx_Math" id="p1.m10">
          \left[\begin{smallmatrix}\bm{I}&amp;-\bm{I}\\
-\bm{I}&amp;\bm{I}\end{smallmatrix}\right]
         </span>
         in the entries of the precision matrix
         <span class="ltx_Math" id="p1.m11">
          \bm{Q}
         </span>
         corresponding to the 2D positions of Agents 2 and 3 at
         <span class="ltx_Math" id="p1.m12">
          \frac{T}{2}
         </span>
         . With this formulation, the two positions are constrained to be the same, without having to predetermine the position at which the two agents should meet.
         <span class="ltx_note ltx_role_footnote" id="footnote2">
          <sup class="ltx_note_mark">
           2
          </sup>
          <span class="ltx_note_outer">
           <span class="ltx_note_content">
            <sup class="ltx_note_mark">
             2
            </sup>
            <span class="ltx_tag ltx_tag_note">
             2
            </span>
            Indeed, we can see that a cost
            <span class="ltx_Math" id="footnote2.m1">
             c\!=\!\left[\begin{smallmatrix}x_{i}\\
x_{j}\end{smallmatrix}\right]^{\scriptscriptstyle\top}\left[\begin{smallmatrix}1&amp;-1\\
-1&amp;1\end{smallmatrix}\right]\left[\begin{smallmatrix}x_{i}\\
x_{j}\end{smallmatrix}\right]\!=\!(x_{i}-x_{j})^{2}
            </span>
            is minimized when
            <span class="ltx_Math" id="footnote2.m2">
             x_{i}\!=\!x_{j}
            </span>
            .
           </span>
          </span>
         </span>
        </p>
       </div>
       <div class="ltx_para" id="p2">
        <p class="ltx_p">
         The evolution of the system is described by the linear relation
         <span class="ltx_Math" id="p2.m1">
          \bm{\dot{x}}_{t}=\bm{A}^{c}_{t}\bm{x}_{t}+\bm{B}^{c}_{t}\bm{u}_{t}
         </span>
         , gathering the behavior of the 3 agents (left hand, right hand and ball) as double integrators with motions affected by gravity.
For
         <span class="ltx_Math" id="p2.m2">
          t\!\leq\!\frac{T}{4}
         </span>
         (left hand holding the ball), we have
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="E114">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="E114.m1">
             \underbrace{\left[\begin{array}{c}\mathbf{\dot{x}}_{1,t}\\
\mathbf{\ddot{x}}_{1,t}\\
\bm{\dot{f}}_{1,t}\\
\hline\cr\mathbf{\dot{x}}_{2,t}\\
\mathbf{\ddot{x}}_{2,t}\\
\bm{\dot{f}}_{2,t}\\
\hline\cr\mathbf{\dot{x}}_{3,t}\\
\mathbf{\ddot{x}}_{3,t}\\
\bm{\dot{f}}_{3,t}\end{array}\right]}_{\bm{\dot{x}}_{t}}=\underbrace{\left[\begin{array}{ccc|ccc|ccc}\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\color{red}\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\color{red}\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\end{array}\right]}_{\bm{A}^{c}_{t}}\underbrace{\left[\begin{array}{c}\mathbf{x}_{1,t}\\
\mathbf{\dot{x}}_{1,t}\\
\bm{f}_{1,t}\\
\hline\cr\mathbf{x}_{2,t}\\
\mathbf{\dot{x}}_{2,t}\\
\bm{f}_{2,t}\\
\hline\cr\mathbf{x}_{3,t}\\
\mathbf{\dot{x}}_{3,t}\\
\bm{f}_{3,t}\end{array}\right]}_{\bm{x}_{t}}+\underbrace{\left[\begin{array}{c|c}\bm{0}&amp;\bm{0}\\
\bm{I}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{I}\\
\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\end{array}\right]}_{\bm{B}^{c}_{t}}\underbrace{\left[\begin{array}{c}\bm{u}_{1,t}\\
\hline\cr\bm{u}_{2,t}\end{array}\right]}_{\bm{u}_{t}}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
         <div class="ltx_eqn_eqno">
          <div>
           (114)
          </div>
         </div>
        </div>
        <p class="ltx_p">
         At
         <span class="ltx_Math" id="p2.m3">
          t\!=\!\frac{T}{2}
         </span>
         (right hand hitting the ball), we have
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="E115">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="E115.m1">
             \underbrace{\left[\begin{array}{c}\mathbf{\dot{x}}_{1,t}\\
\mathbf{\ddot{x}}_{1,t}\\
\bm{\dot{f}}_{1,t}\\
\hline\cr\mathbf{\dot{x}}_{2,t}\\
\mathbf{\ddot{x}}_{2,t}\\
\bm{\dot{f}}_{2,t}\\
\hline\cr\mathbf{\dot{x}}_{3,t}\\
\mathbf{\ddot{x}}_{3,t}\\
\bm{\dot{f}}_{3,t}\end{array}\right]}_{\bm{\dot{x}}_{t}}=\underbrace{\left[\begin{array}{ccc|ccc|ccc}\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\color{red}\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\color{red}\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\end{array}\right]}_{\bm{A}^{c}_{t}}\underbrace{\left[\begin{array}{c}\mathbf{x}_{1,t}\\
\mathbf{\dot{x}}_{1,t}\\
\bm{f}_{1,t}\\
\hline\cr\mathbf{x}_{2,t}\\
\mathbf{\dot{x}}_{2,t}\\
\bm{f}_{2,t}\\
\hline\cr\mathbf{x}_{3,t}\\
\mathbf{\dot{x}}_{3,t}\\
\bm{f}_{3,t}\end{array}\right]}_{\bm{x}_{t}}+\underbrace{\left[\begin{array}{c|c}\bm{0}&amp;\bm{0}\\
\bm{I}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{I}\\
\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\end{array}\right]}_{\bm{B}^{c}_{t}}\underbrace{\left[\begin{array}{c}\bm{u}_{1,t}\\
\hline\cr\bm{u}_{2,t}\end{array}\right]}_{\bm{u}_{t}}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
         <div class="ltx_eqn_eqno">
          <div>
           (115)
          </div>
         </div>
        </div>
        <p class="ltx_p">
         For
         <span class="ltx_Math" id="p2.m4">
          \frac{T}{4}\!&lt;\!t\!&lt;\!\frac{T}{2}
         </span>
         and
         <span class="ltx_Math" id="p2.m5">
          t\!&gt;\!\frac{T}{2}
         </span>
         (free motion of the ball), we have
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="E116">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="E116.m1">
             \underbrace{\left[\begin{array}{c}\mathbf{\dot{x}}_{1,t}\\
\mathbf{\ddot{x}}_{1,t}\\
\bm{\dot{f}}_{1,t}\\
\hline\cr\mathbf{\dot{x}}_{2,t}\\
\mathbf{\ddot{x}}_{2,t}\\
\bm{\dot{f}}_{2,t}\\
\hline\cr\mathbf{\dot{x}}_{3,t}\\
\mathbf{\ddot{x}}_{3,t}\\
\bm{\dot{f}}_{3,t}\end{array}\right]}_{\bm{\dot{x}}_{t}}=\underbrace{\left[\begin{array}{ccc|ccc|ccc}\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{I}\\
\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}&amp;\bm{0}\end{array}\right]}_{\bm{A}^{c}_{t}}\underbrace{\left[\begin{array}{c}\mathbf{x}_{1,t}\\
\mathbf{\dot{x}}_{1,t}\\
\bm{f}_{1,t}\\
\hline\cr\mathbf{x}_{2,t}\\
\mathbf{\dot{x}}_{2,t}\\
\bm{f}_{2,t}\\
\hline\cr\mathbf{x}_{3,t}\\
\mathbf{\dot{x}}_{3,t}\\
\bm{f}_{3,t}\end{array}\right]}_{\bm{x}_{t}}+\underbrace{\left[\begin{array}{c|c}\bm{0}&amp;\bm{0}\\
\bm{I}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{I}\\
\bm{0}&amp;\bm{0}\\
\hline\cr\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\\
\bm{0}&amp;\bm{0}\end{array}\right]}_{\bm{B}^{c}_{t}}\underbrace{\left[\begin{array}{c}\bm{u}_{1,t}\\
\hline\cr\bm{u}_{2,t}\end{array}\right]}_{\bm{u}_{t}}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
         <div class="ltx_eqn_eqno">
          <div>
           (116)
          </div>
         </div>
        </div>
       </div>
       <div class="ltx_para" id="p3">
        <p class="ltx_p">
         In the above,
         <span class="ltx_Math" id="p3.m1">
          \bm{f}_{i}=m_{i}\bm{g}
         </span>
         represent the effect of gravity on the three agents, with mass
         <span class="ltx_Math" id="p3.m2">
          m_{i}
         </span>
         and acceleration vector
         <span class="ltx_Math" id="p3.m3">
          \bm{g}=\left[\begin{smallmatrix}0\\
-9.81\end{smallmatrix}\right]
         </span>
         due to gravity. The parameters
         <span class="ltx_Math" id="p3.m4">
          \{\bm{A}^{c}_{t},\bm{B}^{c}_{t}\}_{t=1}^{T}
         </span>
         , describing a continuous system, are first converted to their discrete forms with
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="eq:AdAc">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="E117.m1">
             \bm{A}_{t}=\bm{I}+\bm{A}^{c}_{t}\Delta t,\quad\bm{B}_{t}=\bm{B}^{c}_{t}\Delta t,\quad\forall t\in\{1,\ldots,T\},
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
         <div class="ltx_eqn_eqno">
          <div>
           (117)
          </div>
         </div>
        </div>
        <p class="ltx_p">
         which can then be used to define sparse transfer matrices
         <span class="ltx_Math" id="p3.m5">
          \bm{S}_{\bm{x}}
         </span>
         and
         <span class="ltx_Math" id="p3.m6">
          \bm{S}_{\bm{u}}
         </span>
         describing the evolution of the system in a vector form, starting from an initial state
         <span class="ltx_Math" id="p3.m7">
          \bm{x}_{1}
         </span>
         , namely
         <span class="ltx_Math" id="p3.m8">
          \bm{x}=\bm{S}_{\bm{x}}\bm{x}_{1}+\bm{S}_{\bm{u}}\bm{u}
         </span>
         .
        </p>
       </div>
       <ul class="pagination justify-content-center small_menu">
        <li class="page-item previous_file">
         <a class="page-link" href="A2.html">
          Previous
         </a>
        </li>
        <li class="page-item next_file">
         <a class="page-link" href="A4.html">
          Next
         </a>
        </li>
       </ul>
      </div>
     </div>
     <div class="col-sm-3">
      <div id="img-col">
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
