<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Robotics codes from scratch (RCFS) is a collection of source codes to study and test learning and optimization problems in robotics through simple 2D examples." name="description"/>
  <meta content="robotics codes, robotics tutorial, rcfs, robotics from scratch" name="keywords"/>
  <meta content="Sylvain Calinon" name="author"/>
  <title>
   RCFS
  </title>
  <link href="static_images/favicon.ico" rel="icon" sizes="any"/>
  <link href="static_images/favicon.svg" rel="icon" type="image/svg+xml"/>
  <link href="css/bootstrap.min.css" rel="stylesheet"/>
  <link href="css/bootstrap-icons-1.10.4/font/bootstrap-icons.css" rel="stylesheet"/>
  <link href="css/permanent_marker.css" rel="stylesheet"/>
  <link href="css/main-template.css" rel="stylesheet"/>
  <link href="css/sidebars.css" rel="stylesheet"/>
  <link href="css/katex.min.css" rel="stylesheet"/>
  <script src="js/jquery-3.6.4.min.js">
  </script>
  <script src="js/bootstrap.bundle.min.js">
  </script>
  <script src="js/katex.min.js">
  </script>
  <script>
   function initialize(){
                convertMath();
                alignImages();
            }

            function convertMath(){
                const elements = document.getElementsByClassName("ltx_Math");
                const macros = {
				'\\tp': '\\text{\\tiny{#1}}',
				'\\trsp' : '\\top',
				'\\psin' : '\\dagger',
				'\\eqref': '\\href{###1}{(\\text{#1})}',
				'\\ref': '\\href{###1}{\\text{#1}}',
				'\\label': '\\htmlId{#1}{}'
			};
                for(let element of elements){
                    katex.render(element.textContent, element, {
                        throwOnError: false,
                        macros
                    });
                }
            }

            function alignImages(){

                document.getElementsByTagName('style').innerHTML = '';

                let txt_height = document.querySelector('#txt-col').offsetHeight;
                let img_height = document.querySelector('#img-col').offsetHeight;

                let margin = 50;

                if(txt_height > img_height && screen.width >= 576){
                    let nb_figures = document.querySelectorAll('.figure_main').length;
                    let computed_margin = (txt_height - img_height) / nb_figures;

                    if(computed_margin > margin){
                        margin = computed_margin;
                    }
                }

                const style = document.createElement('style');
                style.innerHTML = '.figure_main{ padding-top:'+Math.round(margin/2)+'px; padding-bottom:'+Math.round(margin/2)+'px; }';
                document.head.appendChild(style);
            }

            window.onload = initialize;
            window.onorientationchange = alignImages;
  </script>
 </head>
 <body>
  <nav aria-label="Light offcanvas navbar" class="navbar fixed-top" style="width: 50px;">
   <div class="container-fluid">
    <button aria-controls="offcanvasNavbarLight" class="navbar-toggler" data-bs-target="#offcanvasNavbarLight" data-bs-toggle="offcanvas" type="button">
     <span class="navbar-toggler-icon" style="cursor: pointer;">
     </span>
    </button>
    <div aria-labelledby="offcanvasNavbarLightLabel" class="offcanvas offcanvas-start" id="offcanvasNavbarLight" style="width: 500px;" tabindex="-1">
     <div class="offcanvas-header">
      <!--style='height: 50px;'-->
      <a class="navbar-brand" href="index.html">
       <h4 class="offcanvas-title" id="offcanvasNavbarLightLabel">
        <i class="bi bi-code-slash">
        </i>
        RCFS
       </h4>
      </a>
      <button aria-label="Close" class="btn-close" data-bs-dismiss="offcanvas" type="button">
      </button>
     </div>
     <div class="offcanvas-body">
      <!--Menu goes here-->
      <ul class="list-unstyled ps-0">
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="true" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#general-collapse" data-bs-toggle="collapse">
         General information
        </button>
        <div class="collapse show" id="general-collapse">
         <!--<li><a href='index.html' class='link-dark d-inline-flex text-decoration-none rounded'>Home</a></li>-->
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="about.html">
            <div class="p-1 mb-0">
             About
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="license.html">
            <div class="p-1 mb-0">
             License
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#sandboxes2d-collapse" data-bs-toggle="collapse">
         2D sandboxes
        </button>
        <div class="collapse" id="sandboxes2d-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_FK.html">
            <div class="p-1 mb-0">
             Forward kinematics (FK)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_IK.html">
            <div class="p-1 mb-0">
             Inverse kinematics (IK)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_bimanual.html">
            <div class="p-1 mb-0">
             Bimanual robot
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_humanoid.html">
            <div class="p-1 mb-0">
             Humanoid robot (CoM and coordination matrix)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_iLQR.html">
            <div class="p-1 mb-0">
             Iterative linear quadratic regulator (iLQR)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_iLQR_car.html">
            <div class="p-1 mb-0">
             iLQR for car
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox_iLQR_bicopter.html">
            <div class="p-1 mb-0">
             iLQR for bicopter
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#sandboxes3d-collapse" data-bs-toggle="collapse">
         3D sandboxes
        </button>
        <div class="collapse" id="sandboxes3d-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="sandbox3d_IK.html">
            <div class="p-1 mb-0">
             Inverse kinematics (IK)
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#exercises-collapse" data-bs-toggle="collapse">
         Exercises
        </button>
        <div class="collapse" id="exercises-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise01.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             01
            </div>
            <div class="p-1 mb-0">
             Linear algebra in Python
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise02.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             02
            </div>
            <div class="p-1 mb-0">
             Movement primitives and Newton's method
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise03.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             03
            </div>
            <div class="p-1 mb-0">
             Gaussian Distributions
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise04a.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             4a
            </div>
            <div class="p-1 mb-0">
             Forward kinematics
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise04b.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             4b
            </div>
            <div class="p-1 mb-0">
             Inverse kinematics and nullspace control
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise05a.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             5a
            </div>
            <div class="p-1 mb-0">
             Forward dynamics
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise05b.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             5b
            </div>
            <div class="p-1 mb-0">
             Inverse dynamics and impedance control
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise06a.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             6a
            </div>
            <div class="p-1 mb-0">
             Planning with linear quadratic regulator
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise06b.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             6b
            </div>
            <div class="p-1 mb-0">
             Planning in joint space with LQR
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise07.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             07
            </div>
            <div class="p-1 mb-0">
             Iterative linear quadratic regulator (iLQR)
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise08.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             08
            </div>
            <div class="p-1 mb-0">
             Exploration with ergodic control
            </div>
           </a>
          </li>
          <li>
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="exercise09.html">
            <div class="p-1 mb-0 bg-dark text-white font-monospace">
             09
            </div>
            <div class="p-1 mb-0">
             Orientation with Riemannian manifold
            </div>
           </a>
          </li>
         </ul>
        </div>
       </li>
       <li class="border-top my-1">
       </li>
       <li class="mb-1">
        <button aria-expanded="false" class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-target="#doc-collapse" data-bs-toggle="collapse">
         Online courses
        </button>
        <div class="collapse" id="doc-collapse">
         <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small" id="menu_container">
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="toc.html" style="font-weight:bold;">
            Table of contents
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S1.html" style="font-weight:bold;">
            1 Introduction
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html" style="font-weight:bold;">
            2 Newton’s method for minimization
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html#sec:GaussNewton">
               <span class="p-1 mb-0">
                2.1 Gauss–Newton algorithm
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html#sec:LS">
               <span class="p-1 mb-0">
                2.2 Least squares
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S2.html#sec:LSconstraints">
               <span class="p-1 mb-0">
                2.3 Least squares with constraints
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S3.html" style="font-weight:bold;">
            3 Forward kinematics (FK) for a planar robot manipulator
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S4.html" style="font-weight:bold;">
            4 Inverse kinematics (IK) for a planar robot manipulator
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S4.html#sec:IKnum">
               <span class="p-1 mb-0">
                4.1 Numerical estimation of the Jacobian
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S4.html#sec:IK_nullspace">
               <span class="p-1 mb-0">
                4.2 Inverse kinematics (IK) with task prioritization
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html" style="font-weight:bold;">
            5 Encoding with basis functions
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS1">
               <span class="p-1 mb-0">
                5.1 Univariate trajectories
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS2">
               <span class="p-1 mb-0">
                5.2 Multivariate trajectories
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS3">
               <span class="p-1 mb-0">
                5.3 Multidimensional inputs
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS4">
               <span class="p-1 mb-0">
                5.4 Derivatives
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS5">
               <span class="p-1 mb-0">
                5.5 Concatenated basis functions
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS6">
               <span class="p-1 mb-0">
                5.6 Batch computation of basis functions coefficients
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S5.html#SS7">
               <span class="p-1 mb-0">
                5.7 Recursive computation of basis functions coefficients
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html" style="font-weight:bold;">
            6 Linear quadratic tracking (LQT)
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#SS1">
               <span class="p-1 mb-0">
                6.1 LQT with smoothness cost
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#SS2">
               <span class="p-1 mb-0">
                6.2 LQT with control primitives
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:LQRrecursive">
               <span class="p-1 mb-0">
                6.3 LQR with a recursive formulation
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:augmState">
               <span class="p-1 mb-0">
                6.4 LQT with a recursive formulation and an augmented state space
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:LQRLS">
               <span class="p-1 mb-0">
                6.5 Least squares formulation of recursive LQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S6.html#sec:DMPLQT">
               <span class="p-1 mb-0">
                6.6 Dynamical movement primitives (DMP) reformulated as LQT with control primitives
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html" style="font-weight:bold;">
            7 iLQR optimization
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#sec:iLQRbatch">
               <span class="p-1 mb-0">
                7.1 Batch formulation of iLQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#sec:iLQRrecursive">
               <span class="p-1 mb-0">
                7.2 Recursive formulation of iLQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#sec:iLQRLS">
               <span class="p-1 mb-0">
                7.3 Least squares formulation of recursive iLQR
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS4">
               <span class="p-1 mb-0">
                7.4 Updates by considering step sizes
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS5">
               <span class="p-1 mb-0">
                7.5 iLQR with quadratic cost on f(x_{t})
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS6">
               <span class="p-1 mb-0">
                7.6 iLQR with control primitives
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS7">
               <span class="p-1 mb-0">
                7.7 iLQR for spacetime optimization
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS8">
               <span class="p-1 mb-0">
                7.8 iLQR with offdiagonal elements in the precision matrix
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS9">
               <span class="p-1 mb-0">
                7.9 Car steering
               </span>
              </a>
             </li>
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S7.html#SS10">
               <span class="p-1 mb-0">
                7.10 Bicopter
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="S8.html" style="font-weight:bold;">
            8 Forward dynamics (FD) for a planar robot manipulator
           </a>
           <div>
            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
             <li>
              <a class="link-dark d-inline-flex text-decoration-none rounded" href="S8.html#SS1">
               <span class="p-1 mb-0">
                8.1 Robot manipulator with dynamics equation
               </span>
              </a>
             </li>
            </ul>
           </div>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="bib.html" style="font-weight:bold;">
            References
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A1.html" style="font-weight:bold;">
            A System dynamics at trajectory level
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A2.html" style="font-weight:bold;">
            B Derivation of motion equation for a planar robot
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A3.html" style="font-weight:bold;">
            C Linear systems used in the bimanual tennis serve example
           </a>
          </li>
          <li class="mb-1 generated-menu-item">
           <a class="link-dark d-inline-flex text-decoration-none rounded" href="A4.html" style="font-weight:bold;">
            D Equivalence between LQT and LQR with augmented state space
           </a>
          </li>
         </ul>
        </div>
       </li>
      </ul>
     </div>
    </div>
   </div>
  </nav>
  <div class="container-fluid">
   <!--<center><h1 class="title">My Title</h1></center>-->
   <div id="data_container">
    <div class="row">
     <div class="col-sm-7 offset-1">
      <div id="txt-col">
       <h1 class="ltx_title ltx_title_appendix">
        <span class="ltx_tag ltx_tag_appendix">
         Appendix B
        </span>
        Derivation of motion equation for a planar robot
       </h1>
       <div class="ltx_para" id="p1">
        <p class="ltx_p">
         We derive each element in (
         <a class="ltx_ref" href="S8.html#eq:Lag_with_generalized_forces" title="(106) ‣ 8 Forward dynamics (FD) for a planar robot manipulator ‣ A practical guide to learning and control problems in robotics solved with second-order optimization">
          <span class="ltx_text ltx_ref_tag">
           106
          </span>
         </a>
         ) individually for
         <span class="ltx_Math" id="p1.m1">
          j\geq z
         </span>
         , then combine them altogether to derive the dynamic equation of the system. In this regard, for the first element in (
         <a class="ltx_ref" href="S8.html#eq:Lag_with_generalized_forces" title="(106) ‣ 8 Forward dynamics (FD) for a planar robot manipulator ‣ A practical guide to learning and control problems in robotics solved with second-order optimization">
          <span class="ltx_text ltx_ref_tag">
           106
          </span>
         </a>
         ), we can write
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="Ex141">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex141.m1">
             \frac{\partial T_{j}}{\partial\dot{q}_{z}}=m_{j}\Big(\frac{\partial\dot{f}_{j,1}}{\partial\dot{q}_{z}}\dot{f}_{j,1}+\frac{\partial\dot{f}_{j,2}}{\partial\dot{q}_{z}}\dot{f}_{j,2}\Big)=m_{j}\Big(\Big(-l_{z}s_{z}\Big)\dot{f}_{j,1}+\Big(l_{z}c_{z}\Big)\dot{f}_{j,2}\Big),
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
        <p class="ltx_p">
         whose time derivative can be expressed as
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="Ex142">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex142.m1">
             \frac{d}{dt}\frac{\partial T_{j}}{\partial\dot{q}_{z}}=m_{j}\Big(\Big(-l_{z}\dot{q}_{z}c_{z}\Big)\dot{f}_{j,1}-\Big(l_{z}s_{z}\Big)\ddot{f}_{j,1}-\Big(l_{z}\dot{q}_{z}s_{z}\Big)\dot{f}_{j,2}+\Big(l_{z}c_{z}\Big)\ddot{f}_{j,2}\Big),
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
        <p class="ltx_p">
         where
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="Ex143">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex143.m1">
             \ddot{f}_{j,1}=-\sum_{k=1}^{j}l_{k}\ddot{q}_{k}s_{k}-\sum_{k=1}^{j}l_{k}\dot{q}_{k}^{2}c_{k},\quad\ddot{f}_{j,2}=\sum_{k=1}^{j}l_{k}\ddot{q}_{k}c_{k}-\sum_{k=1}^{j}l_{k}\dot{q}_{k}^{2}s_{k}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
       </div>
       <div class="ltx_para" id="p2">
        <p class="ltx_p">
         For the second term in (
         <a class="ltx_ref" href="S8.html#eq:Lag_with_generalized_forces" title="(106) ‣ 8 Forward dynamics (FD) for a planar robot manipulator ‣ A practical guide to learning and control problems in robotics solved with second-order optimization">
          <span class="ltx_text ltx_ref_tag">
           106
          </span>
         </a>
         ), we can write
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="eq:lagrangian_second_term">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex144.m1">
             \frac{\partial T_{j}}{\partial q_{z}}=m_{j}\Big(\frac{\partial\dot{f}_{j,1}}{\partial q_{z}}\dot{f}_{j,1}+\frac{\partial\dot{f}_{j,2}}{\partial q_{z}}\dot{f}_{j,2}\Big)=m_{j}\Bigg(\Big(-l_{z}\dot{q}_{z}c_{z}\Big)\dot{f}_{j,1}-\Big(l_{z}\dot{q}_{z}s_{z}\Big)\dot{f}_{j,2}\Bigg),
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
        <p class="ltx_p">
         and finally, the potential energy term can be calculated as
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="Ex145">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex145.m1">
             \frac{\partial U_{j}}{\partial q_{z}}=m_{j}gl_{z}c_{z}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
       </div>
       <div class="ltx_para" id="p3">
        <p class="ltx_p">
         The z-
         <em class="ltx_emph ltx_font_italic">
          th
         </em>
         generalized force can be found by substituting the derived terms to (
         <a class="ltx_ref" href="S8.html#eq:Lag_with_generalized_forces" title="(106) ‣ 8 Forward dynamics (FD) for a planar robot manipulator ‣ A practical guide to learning and control problems in robotics solved with second-order optimization">
          <span class="ltx_text ltx_ref_tag">
           106
          </span>
         </a>
         ) as
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx25">
          <tbody id="Ex146">
           <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
            <td class="ltx_eqn_cell ltx_eqn_center_padleft">
            </td>
            <td class="ltx_td ltx_align_right ltx_eqn_cell">
             <span class="ltx_Math" id="Ex146.m1">
              \displaystyle u_{z}
             </span>
            </td>
            <td class="ltx_td ltx_align_left ltx_eqn_cell">
             <span class="ltx_Math" id="Ex146.m2">
              \displaystyle=\sum_{j=z}^{N}\Big(m_{j}\Big(\Big(-l_{z}\dot{q}_{z}c_{z}\Big)\dot{r}_{j,1}-\Big(l_{z}s_{k}\Big)\ddot{r}_{j,1}-\Big(l_{z}\dot{q}_{z}s_{z}\Big)\dot{r}_{j,2}+\Big(l_{z}c_{z}\Big)\ddot{r}_{j,2}\Big)-m_{j}\Big(\Big(-l_{z}\dot{q}_{z}c_{z}\Big)\dot{r}_{j,1}-\Big(l_{z}\dot{q}_{z}s_{z}\Big)\dot{r}_{j,2}\Big)+m_{j}gl_{z}c_{z}\Big)
             </span>
            </td>
            <td class="ltx_eqn_cell ltx_eqn_center_padright">
            </td>
           </tr>
          </tbody>
          <tbody id="Ex147">
           <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
            <td class="ltx_eqn_cell ltx_eqn_center_padleft">
            </td>
            <td class="ltx_td ltx_eqn_cell">
            </td>
            <td class="ltx_td ltx_align_left ltx_eqn_cell">
             <span class="ltx_Math" id="Ex147.m1">
              \displaystyle=\sum_{j=z}^{N}\Big(m_{j}\Big(\Big(-l_{z}s_{z}\Big)\ddot{r}_{j,1}+\Big(l_{z}c_{z}\Big)\ddot{r}_{j,2}\Big)+m_{j}gl_{z}c_{z}\Big)
             </span>
            </td>
            <td class="ltx_eqn_cell ltx_eqn_center_padright">
            </td>
           </tr>
          </tbody>
          <tbody id="Ex148">
           <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
            <td class="ltx_eqn_cell ltx_eqn_center_padleft">
            </td>
            <td class="ltx_td ltx_eqn_cell">
            </td>
            <td class="ltx_td ltx_align_left ltx_eqn_cell">
             <span class="ltx_Math" id="Ex148.m1">
              \displaystyle=\sum_{j=z}^{N}\Big(m_{j}\Big(\Big(-l_{z}s_{z}\Big)\Big(-\sum_{k=1}^{j}l_{k}\ddot{q}_{k}s_{k}-\sum_{k=1}^{j}l_{k}\dot{q}_{k}^{2}c_{k}\Big)+\Big(l_{z}c_{z}\Big)\Big(\sum_{k=1}^{j}l_{k}\ddot{q}_{k}c_{k}-\sum_{k=1}^{j}l_{k}\dot{q}_{k}^{2}s_{k}\Big)\Big)+m_{j}gl_{z}c_{z}\Big)
             </span>
            </td>
            <td class="ltx_eqn_cell ltx_eqn_center_padright">
            </td>
           </tr>
          </tbody>
          <tbody id="Ex149">
           <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
            <td class="ltx_eqn_cell ltx_eqn_center_padleft">
            </td>
            <td class="ltx_td ltx_eqn_cell">
            </td>
            <td class="ltx_td ltx_align_left ltx_eqn_cell">
             <span class="ltx_Math" id="Ex149.m1">
              \displaystyle=\sum_{j=z}^{N}m_{j}\Big(\sum_{k=1}^{j}l_{z}l_{k}c_{z-k}\ddot{q}_{k}+\sum_{k=1}^{j}l_{z}l_{k}s_{z-k}\dot{q}_{k}^{2}\Big)+\sum_{j=z}^{N}m_{j}gl_{z}c_{z},
             </span>
            </td>
            <td class="ltx_eqn_cell ltx_eqn_center_padright">
            </td>
           </tr>
          </tbody>
         </table>
        </div>
        <p class="ltx_p">
         where
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="Ex150">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex150.m1">
             c_{h-k}=c_{h}c_{k}-s_{h}s_{k},\ \ \ s_{h-k}=s_{h}c_{k}-c_{h}s_{k}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
       </div>
       <div class="ltx_para" id="p4">
        <p class="ltx_p">
         By rearranging the order of elements, we can write
        </p>
        <div class="equation" style="display:flex;align-items:center;">
         <table class="ltx_equation ltx_eqn_table" id="Ex151">
          <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
           <td class="ltx_eqn_cell ltx_eqn_center_padleft">
           </td>
           <td class="ltx_eqn_cell ltx_align_center">
            <span class="ltx_Math" id="Ex151.m1">
             \sum_{j=z}^{N}m_{j}\Big(\sum_{k=1}^{j}l_{z}l_{k}c_{z-k}\ddot{q}_{k}\Big)=u_{z}-\sum_{j=z}^{N}m_{j}\Big(\sum_{k=1}^{j}l_{z}l_{k}s_{z-k}\dot{q}_{k}^{2}\Big)-\sum_{j=z}^{N}m_{j}gl_{z}c_{z}.
            </span>
           </td>
           <td class="ltx_eqn_cell ltx_eqn_center_padright">
           </td>
          </tr>
         </table>
        </div>
       </div>
       <ul class="pagination justify-content-center small_menu">
        <li class="page-item previous_file">
         <a class="page-link" href="A1.html">
          Previous
         </a>
        </li>
        <li class="page-item next_file">
         <a class="page-link" href="A3.html">
          Next
         </a>
        </li>
       </ul>
      </div>
     </div>
     <div class="col-sm-3">
      <div id="img-col">
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
