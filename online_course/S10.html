<div class="row"><div class="col-sm-7 offset-1"><div id="txt-col"><h1 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section"><span class="ltx_text">10</span> </span><span class="ltx_text">Ergodic control</span>
</h1><div class="ltx_para" id="S10-para:p1">
<p class="ltx_p">Ergodic theory studies the connection between the time-averaged and space-averaged behaviors of a dynamical system. By using it in a search and exploration context, it enables optimal exploration of an information distribution. Exploration problems can be formulated in various ways, see Figures <a class="ltx_ref" href="#S10-fig:F36" title="Figure 36 ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">36</span></a>, <a class="ltx_ref" href="#S10-fig:F37" title="Figure 37 ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">37</span></a> and <a class="ltx_ref" href="#S10-fig:F39" title="Figure 39 ‣ 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">39</span></a>.</p>
</div><div class="ltx_para" id="S10-para:p2">
<p class="ltx_p">Research in ergodic control addresses fundamental challenges linking machine learning, optimal control, signal processing and information theory. A conventional tracking problem in robotics is characterized by a target to reach, requiring a controller to be computed to reach this target. In <em class="ltx_emph ltx_font_italic">ergodic control</em>, instead of providing a single target point, a probability distribution is given to the robot, which must cover the distribution in an efficient way. Ergodic control thus consists of moving within a spatial distribution by spending time in each part of the distribution in proportion to its density.
The term ergodicity corresponds here to the difference between the time-averaged spatial statistics of the agent’s trajectory and the target distribution to search in. By minimizing this difference, the resulting controller generates natural exploration behaviors.</p>
</div><div class="ltx_para" id="S10-para:p3">
<p class="ltx_p">In robotics, ergodic control can be exploited in a wide range of problems requiring the automatic exploration of regions of interest, which can be used in a wide range of tasks, including active sensing, localization, surveillance, or insertion (see Figure <a class="ltx_ref" href="#S10-fig:F38" title="Figure 38 ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">38</span></a> for an example). This is particularly helpful when the available sensing information or robot actuators are not accurate enough to fulfill the task with a standard controller (limited vision, soft robotic manipulator, etc.), but where this information can still guide the robot towards promising areas. In a collaborative task, it can also be used when the operator’s input is not accurate enough to fully reproduce the task, which then requires the robot to explore around the requested input (e.g., a point of interest selected by the operator). For picking and insertion problems, ergodic control can be applied to move around the picking/insertion point, thereby facilitating the prehension/insertion. It can also be employed for active sensing and localization (either detected autonomously, or with help by the operator). Here, the robot can plan movements based on the current information density, and can recompute the commands when new measurements are available (i.e., updating the spatial distribution used as target).</p>
</div><div class="ltx_para" id="S10-para:p4">
<p class="ltx_p">Ergodic control is originally formulated as a <em class="ltx_emph ltx_font_italic">spectral multiscale coverage</em> (SMC) objective <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib20" title="Spectral multiscale coverage: a uniform coverage algorithm for mobile sensor networks">10</a>]</cite>, which we will see next. Other ergodic control techniques have later been proposed, including the <em class="ltx_emph ltx_font_italic">heat equation driven area coverage</em> (HEDAC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib21" title="Ergodicity-based cooperative multiagent area coverage via a potential field">6</a>]</cite>, which we will also be introduced next.</p>
</div><div class="ltx_subsection" id="S10-sec:SS1">
<h2 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text">10.1</span> </span><span class="ltx_text">Spectral-based ergodic control (SMC)</span>
</h2>
<div class="ltx_para" id="S10-para:SS1.p1">
<p class="ltx_p">The underlying objective of <em class="ltx_emph ltx_font_italic">spectral multiscale coverage</em> (SMC) takes a simple form, corresponding to a tracking problem in the spectral domain (matching of frequency components) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib20" title="Spectral multiscale coverage: a uniform coverage algorithm for mobile sensor networks">10</a>]</cite>. The advantage of such a simple control formulation is that it can be easily combined with other control objectives and constraints.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.p2">
<p class="ltx_p">It requires the spatial distribution to be decomposed as Fourier series, with a cost function comparing the spectral decomposition of the robot path with the spectral decomposition of the distribution, in the form of a weighted distance function with a decreasing weight from low frequency to high frequency components. The resulting controller allows the robot to explore the given spatial distribution in a natural manner, <span class="ltx_text ltx_font_bold">by starting from a crude exploration and by refining the search progressively</span> (i.e., matching the Fourier coefficients with an increasing importance from low to high frequency components).</p>
</div>
<figure class="ltx_figure figure_main" id="S10-fig:F36"><a href="online_course/images/ergodicVsPatternedSearch01.jpg" target="_blank"><img class="ltx_graphics ltx_centering ltx_img_landscape" id="F36.g1" src="online_course/images/small/ergodicVsPatternedSearch01.jpg"/></a>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 36</span>: </span><span class="ltx_text">Search and exploration problems can be formulated in various ways. Ergodic control can be used in a search problem in which we do not know the duration of the exploration (e.g., we would like to find a hidden target as soon as possible). In contrast to stochastic sampling of a distribution, ergodic control takes into account the cost to move the agent from one point to another. If the search optimization problem is formulated as a coverage problem with fixed duration, the optimal path typically reveals some regular coverage patterns (here, illustrated as spirals, but also called lawnmower strategy). Ergodic control instead generates a more natural search behavior to localize the object to search by starting with a crude coverage of the workspace and by then generating progressively more detailed paths to cover the distribution. This for example resembles the way we would search for keys in a house by starting with a distribution about the locations in the rooms in which we believe the keys could be, and by covering these distribution coarsely as a first pass, followed by progressive refinement about the search with more detailed coverage until the keys are found. Both stochastic samples or patterned search would be very inefficient here!

</span></figcaption>
</figure>
<figure class="ltx_figure figure_main" id="S10-fig:F37">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column">Ergodic search</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column">Patterned search</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center"><a href="online_course/images/SMC-room002.jpg" target="_blank"><img class="ltx_graphics ltx_img_square" id="F37.g1" src="online_course/images/small/SMC-room002.jpg"/></a></td>
<td class="ltx_td ltx_align_center"><a href="online_course/images/SMC-room001.jpg" target="_blank"><img class="ltx_graphics ltx_img_square" id="F37.g2" src="online_course/images/small/SMC-room001.jpg"/></a></td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center"><a href="online_course/images/SMC-room002c.jpg" target="_blank"><img class="ltx_graphics ltx_img_square" id="F37.g3" src="online_course/images/small/SMC-room002c.jpg"/></a></td>
<td class="ltx_td ltx_align_center"><a href="online_course/images/SMC-room001c.jpg" target="_blank"><img class="ltx_graphics ltx_img_square" id="F37.g4" src="online_course/images/small/SMC-room001c.jpg"/></a></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 37</span>: </span><span class="ltx_text">Example illustrating the search of a key in a living room, where regions of interest are specified in the form of a distribution over the spatial domain. These regions of interest correspond here to the different tables in the room where it is more likely to find the key. The left and right columns respectively depict an ergodic search and patterned search processes. For a coverage problem in which the duration is given in advance, a patterned search can typically be better suited than an ergodic control search, because the agent will optimize the path to reduce the number of transitions from one area to the other. In contrast, an ergodic control search will typically result in multiple transitions between the different regions of interest. When searching for a key, since we are interested in finding the key as early as possible, we have a problem in which the total search duration cannot be specified in advance. In this problem setting, an ergodic search will be better suited than a patterned search, as it generates a natural way of exploring the environment by first proceeding with a crude search in the whole space and by then progressively fine-tuning the search with additional details until the key is finally found. The bottom row shows an example in which the key location is unknown, with the search process stopping when the key is found. Here, a patterned search would provide an inefficient and unnatural way of scanning the whole environment regularly by looking at all details regions by regions, instead of treating the problem at different scales (i.e., at different spatial frequencies), which is what ergodic exploration provides.
</span></figcaption>
</figure>
<figure class="ltx_figure figure_main" id="S10-fig:F38"><a href="online_course/images/ergodic01.png" target="_blank"><img class="ltx_graphics ltx_img_landscape" id="F38.g1" src="online_course/images/small/ergodic01.png"/></a>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 38</span>: </span><span class="ltx_text">Insertion tasks can be achieved robustly with ergodic control, by not only relying on accurate sensors, but instead using a control strategy to cope with limited or inaccurate sensing information, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib7" title="Ergodic exploration using tensor train: applications in insertion tasks">18</a>]</cite> for details.

</span></figcaption>
</figure>
<div class="ltx_subsubsection" id="S10-sec:SS1.SSS1">
<h3 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text">10.1.1</span> </span><span class="ltx_text">Unidimensional SMC</span>
</h3>
<figure class="ltx_table" id="S10-tbl:T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text">Table 1</span>: </span><span class="ltx_text">Fourier series properties (1D case).</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel"><span class="ltx_text ltx_font_bold">Symmetry property:
<br class="ltx_break"/></span>If <span class="ltx_Math" id="T1.m1">g(x)</span> is real and even, <span class="ltx_Math" id="T1.m2">\phi_{k}(x)</span> in (<a class="ltx_ref" href="#S10-eq:E129" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">129</span></a>) is also real and even, simplifying to <span class="ltx_Math" id="T1.m3">\phi_{k}(x)=\frac{1}{L}\cos\!\left(\frac{2\pi kx}{L}\right)</span>, which then, in practice, only needs an evaluation on the range <span class="ltx_Math" id="T1.m4">k\!\in\![0,\ldots,K\!-\!1]</span>, as the basis functions are even. We then have <span class="ltx_Math" id="T1.m5">g(x)=w_{0}+\sum_{k=1}^{K\!-\!1}w_{k}\,2\cos\!\left(\frac{2\pi kx}{L}\right)</span>, by exploiting <span class="ltx_Math" id="T1.m6">\cos(0)\!=\!1</span>.
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel"><span class="ltx_text ltx_font_bold">Shift property:
<br class="ltx_break"/></span>If <span class="ltx_Math" id="T1.m7">w_{k}</span> are the Fourier series coefficients of a function <span class="ltx_Math" id="T1.m8">g(x)</span>, <span class="ltx_Math" id="T1.m9">\exp(-i\frac{2\pi k\mu}{L})w_{k}</span> are the Fourier coefficients of <span class="ltx_Math" id="T1.m10">g(x-\mu)</span>.
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel"><span class="ltx_text ltx_font_bold">Combination property:
<br class="ltx_break"/></span>If <span class="ltx_Math" id="T1.m11">w_{k,1}</span> (resp. <span class="ltx_Math" id="T1.m12">w_{k,2}</span>) are the Fourier series coefficients of a function <span class="ltx_Math" id="T1.m13">g_{1}(x)</span> (resp. <span class="ltx_Math" id="T1.m14">g_{2}(x)</span>), then <span class="ltx_Math" id="T1.m15">\alpha_{1}w_{k,1}+\alpha_{2}w_{k,2}</span> are the Fourier coefficients of <span class="ltx_Math" id="T1.m16">\alpha_{1}g_{1}(x)+\alpha_{2}g_{2}(x)</span>.
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel"><span class="ltx_text ltx_font_bold">Gaussian property:
<br class="ltx_break"/></span>If <span class="ltx_Math" id="T1.m17">g_{0}(x)=\mathcal{N}(x\,|\,0,\sigma^{2})=(2\pi\sigma^{2})^{-\frac{1}{2}}\exp(-\frac{x^{2}}{2\sigma^{2}})</span>
is mirrored to create a real and even periodic function <span class="ltx_Math" id="T1.m18">g(x)</span> of period <span class="ltx_Math" id="T1.m19">L\gg\sigma</span> (implementation details will follow), the corresponding Fourier series coefficients are of the form <span class="ltx_Math" id="T1.m20">w_{k}=\exp(-\frac{2\pi^{2}k^{2}\sigma^{2}}{L^{2}})</span>.
<br class="ltx_break"/></p>
</div>
</div>
</figure>
<div class="ltx_para" id="S10-para:SS1.SSS1.p1">
<p class="ltx_p">We will adopt a notation to make links with the superposition of basis functions seen in Section <a class="ltx_ref" href="#S6" title="6 Encoding with basis functions ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">6</span></a>. By starting with the unidimensional case (system moving along a line segment), we will consider a signal <span class="ltx_Math" id="SS1.SSS1.p1.m1">g(x)</span> varying along a variable <span class="ltx_Math" id="SS1.SSS1.p1.m2">x</span>, where <span class="ltx_Math" id="SS1.SSS1.p1.m3">x</span> will be used as a generic variable that can for example be a time variable or the coordinates of a pixel in an image. The signal <span class="ltx_Math" id="SS1.SSS1.p1.m4">g(x)</span> can be approximated as a weighted superposition of basis functions with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E128">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E128.m1">g(x)=\sum_{k=-K\!+\!1}^{K\!-\!1}w_{k}\,\phi_{k}(x).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(128)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p2">
<p class="ltx_p">The use of Fourier basis functions provides useful connections between the spatial domain and the spectral domain, where <span class="ltx_Math" id="SS1.SSS1.p2.m1">w_{k}</span> and <span class="ltx_Math" id="SS1.SSS1.p2.m2">\phi_{k}(x)</span> denote the coefficients and basis functions of the Fourier series.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p3">
<p class="ltx_p">For a spatial signal <span class="ltx_Math" id="SS1.SSS1.p3.m1">x</span> on the interval <span class="ltx_Math" id="SS1.SSS1.p3.m2">[-\frac{L}{2},\frac{L}{2}]</span> of period <span class="ltx_Math" id="SS1.SSS1.p3.m3">L</span>, the basis functions of the Fourier series with complex exponential functions will be defined as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx42">
<tbody id="S10-eq:Ex117"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="Ex117.m1">\displaystyle\phi_{k}(x)</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="Ex117.m2">\displaystyle=\frac{1}{2L}\exp\!\left(-i\frac{2\pi kx}{L}\right)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S10-eq:E129"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E129.m1">\displaystyle=\frac{1}{2L}\Bigg(\!\cos\!\left(\frac{2\pi kx}{L}\right)-i\,\sin\!\left(\frac{2\pi kx}{L}\right)\!\Bigg),\;\forall k\!\in\![-K\!+\!1,\ldots,K\!-\!1],</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(129)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with <span class="ltx_Math" id="SS1.SSS1.p3.m4">i</span> the imaginary unit of a complex number (<span class="ltx_Math" id="SS1.SSS1.p3.m5">i^{2}=-1</span>).</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p4">
<p class="ltx_p">As detailed in Table <a class="ltx_ref" href="#S10-tbl:T1" title="Table 1 ‣ 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">1</span></a>, when <span class="ltx_Math" id="SS1.SSS1.p4.m1">g(x)</span> is real and even (our case of interest), <span class="ltx_Math" id="SS1.SSS1.p4.m2">\phi_{k}(x)</span> in (<a class="ltx_ref" href="#S10-eq:E129" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">129</span></a>) is also real and even, simplifying to <span class="ltx_Math" id="SS1.SSS1.p4.m3">\phi_{k}(x)=\frac{1}{L}\cos\!\left(\frac{2\pi kx}{L}\right)</span>, which then, in practice, only needs an evaluation on the range <span class="ltx_Math" id="SS1.SSS1.p4.m4">k\!\in\![0,\ldots,K\!-\!1]</span>, using</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E130">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E130.m1">\phi_{k}(x)=\frac{1}{L}\cos\!\left(\frac{2\pi kx}{L}\right),\quad\forall k\!\in\![0,\ldots,K-1].</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(130)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p5">
<p class="ltx_p">The derivatives of (<a class="ltx_ref" href="#S10-eq:E130" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">130</span></a>) with respect to <span class="ltx_Math" id="SS1.SSS1.p5.m1">x</span> are easy to compute, namely</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E131">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E131.m1">\nabla_{\!\!x}\phi_{k}(x)=-\frac{2\pi k}{L^{2}}\sin\!\left(\frac{2\pi kx}{L}\right).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(131)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p6">
<p class="ltx_p">Ergodic control aims to build a controller so that the Fourier series coefficients <span class="ltx_Math" id="SS1.SSS1.p6.m1">w_{k}</span> along a trajectory <span class="ltx_Math" id="SS1.SSS1.p6.m2">x(t)</span> of duration <span class="ltx_Math" id="SS1.SSS1.p6.m3">t</span>, defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E132">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E132.m1">w_{k}=\frac{1}{t}\int_{\tau=0}^{t}\phi_{k}\big(x(\tau)\big)\;d\tau,</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(132)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">will match the Fourier series coefficients <span class="ltx_Math" id="SS1.SSS1.p6.m4">\hat{w}_{k}</span> on the spatial domain <span class="ltx_Math" id="SS1.SSS1.p6.m5">\mathcal{X}</span>, defined as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx43">
<tbody id="S10-eq:E133"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E133.m1">\displaystyle\hat{w}_{k}</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E133.m2">\displaystyle=\int_{x\in\mathcal{X}}\hat{g}(x)\;\phi_{k}(x)\;\text{d}x.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(133)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p7">
<p class="ltx_p">The discretized version of (<a class="ltx_ref" href="#S10-eq:E132" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">132</span></a>) for a discrete number of time steps <span class="ltx_Math" id="SS1.SSS1.p7.m1">T</span> is</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E134">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E134.m1">w_{k}=\frac{1}{T}\sum_{s=1}^{T}\phi_{k}(x_{s}),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(134)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which can be computed recursively by updating <span class="ltx_Math" id="SS1.SSS1.p7.m2">w_{k}</span> at each iteration step.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p8">
<p class="ltx_p">Similarly, the discretized version of (<a class="ltx_ref" href="#S10-eq:E133" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">133</span></a>) for a given spatial resolution can for example be computed on a domain <span class="ltx_Math" id="SS1.SSS1.p8.m1">\mathcal{X}</span> discretized in <span class="ltx_Math" id="SS1.SSS1.p8.m2">X</span> bins as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx44">
<tbody id="S10-eq:E135"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E135.m1">\displaystyle\hat{w}_{k}</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E135.m2">\displaystyle=\sum_{s=1}^{X}\hat{g}(x_{s})\;\phi_{k}(x_{s}),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(135)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS1.p8.m3">x_{s}</span> splits the domain <span class="ltx_Math" id="SS1.SSS1.p8.m4">\mathcal{X}</span> into <span class="ltx_Math" id="SS1.SSS1.p8.m5">X</span> regular intervals.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p9">
<p class="ltx_p">To compute these Fourier series coefficients efficiently, several Fourier series properties can be exploited, including general property such as symmetry, shift, and linear combination, as well as more specific property in the special case when the spatial distribution takes the form of a mixture of Gaussians. These properties are reported in Table <a class="ltx_ref" href="#S10-tbl:T1" title="Table 1 ‣ 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">1</span></a> for the 1D case.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p10">
<p class="ltx_p">Well-known applications of Fourier basis functions in the context of time series include speech processing and the analysis of periodic motions such as gaits.
In ergodic control, the aim is instead to find a series of control commands <span class="ltx_Math" id="SS1.SSS1.p10.m1">u(t)</span> so that the retrieved trajectory <span class="ltx_Math" id="SS1.SSS1.p10.m2">x(t)</span> covers a bounded space <span class="ltx_Math" id="SS1.SSS1.p10.m3">\mathcal{X}</span> in proportion of a desired spatial distribution <span class="ltx_Math" id="SS1.SSS1.p10.m4">\hat{g}(x)</span>. This can be achieved by defining a metric in the spectral domain, by decomposing in Fourier series coefficients both the desired spatial distribution <span class="ltx_Math" id="SS1.SSS1.p10.m5">\hat{g}(x)</span> and the (partially) retrieved trajectory <span class="ltx_Math" id="SS1.SSS1.p10.m6">x(t)</span>, which can exploit the Fourier series properties presented in Table <a class="ltx_ref" href="#S10-tbl:T1" title="Table 1 ‣ 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">1</span></a>, which can also be extended to more dimensions.</p>
</div>
<figure class="ltx_figure ltx_align_floatright figure_main" id="S10-fig:F39"><a href="online_course/images/ergodicControl-fromCrudetoPrecise01.jpg" target="_blank"><img class="ltx_graphics ltx_centering ltx_img_portrait" id="F39.g1" src="online_course/images/small/ergodicControl-fromCrudetoPrecise01.jpg"/></a>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 39</span>: </span><span class="ltx_text">Although ergodic control with SMC is specified in the spectral domain, it can also be interpreted in the spatial domain as a coverage problem in which both the path of the agent and the targeted distributions are blurred with filters of varying strength. With very strong blurring, the agent can match the desired distribution very quickly (first row). The weaker the filter, the more time the agent will need to cover the path to match the details of the distribution (second and third row). As an optimization problem, the weights <span class="ltx_Math" id="F39.m2">\Lambda_{k}</span> are set to promote a good match of the distributions that are strongly blurred (i.e., low frequency components). When this part of the cost goes to zero, the agent can then progressively refine the path so that less blurred distributions can also be matched (i.e., higher frequency components).
</span></figcaption>
</figure>
<div class="ltx_para" id="S10-para:SS1.SSS1.p11">
<p class="ltx_p">The goal of ergodic control is to minimize</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E136">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E136.m1">\epsilon=\frac{1}{2}\sum_{k=0}^{K-1}\Lambda_{k}\Big(w_{k}-\hat{w}_{k}\Big)^{\!2}</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(136)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS1.p11.m1">\Lambda_{k}</span> are weights, <span class="ltx_Math" id="SS1.SSS1.p11.m2">\hat{w}_{k}</span> are the Fourier series coefficients of <span class="ltx_Math" id="SS1.SSS1.p11.m3">\hat{g}(x)</span>, and <span class="ltx_Math" id="SS1.SSS1.p11.m4">w_{k}</span> are the Fourier series coefficients along the trajectory <span class="ltx_Math" id="SS1.SSS1.p11.m5">x(t)</span>. <span class="ltx_Math" id="SS1.SSS1.p11.m6">k\in[0,1,\ldots,K\!-\!1]</span> is a set of <span class="ltx_Math" id="SS1.SSS1.p11.m7">K</span> index vectors.
In (<a class="ltx_ref" href="#S10-eq:E136" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">136</span></a>), the weights</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E137">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E137.m1">\Lambda_{k}=\left(1+k^{2}\right)^{\!-1}</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(137)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">assign more importance on matching low frequency components (related to a metric for Sobolev spaces of negative order).</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p12">
<p class="ltx_p">Practically, the controller will mainly focus on the lowest frequency components at the beginning as these components have a large effect on the cost due to the large weights. When the errors become zero for these components, the controller can then try to progressively reduce higher frequency components.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p13">
<p class="ltx_p">Ergodic control is then set as the constrained problem of computing a control command <span class="ltx_Math" id="SS1.SSS1.p13.m1">\hat{u}(t)</span> at each time step <span class="ltx_Math" id="SS1.SSS1.p13.m2">t</span> with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E138">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E138.m1">\hat{u}(t)=\arg\min_{u(t)}\;\epsilon\big(x(t\!+\!\Delta t)\big),\quad\text{s.t.}\quad\dot{x}(t)=f\big(x(t),u(t)\big),\quad\|u(t)\|\leqslant u^{\max},</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(138)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the simple system <span class="ltx_Math" id="SS1.SSS1.p13.m3">u(t)=\dot{x}(t)</span> is considered (control with velocity commands), and where the error term is approximated with the Taylor series</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E139">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E139.m1">\epsilon\big(x(t\!+\!\Delta t)\big)\;\approx\;\epsilon\big(x(t)\big)\;+\;\dot{\epsilon}\big(x(t)\big)\Delta t\;+\;\frac{1}{2}\ddot{\epsilon}\big(x(t)\big){\Delta t}^{2}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(139)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p14">
<p class="ltx_p">By using (<a class="ltx_ref" href="#S10-eq:E136" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">136</span></a>), (<a class="ltx_ref" href="#S10-eq:E132" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">132</span></a>), (<a class="ltx_ref" href="#S10-eq:E130" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">130</span></a>) and the chain rule <span class="ltx_Math" id="SS1.SSS1.p14.m1">\frac{\partial f}{\partial t}=\frac{\partial f}{\partial x}\frac{\partial x}{\partial t}</span>, the Taylor series is composed of the control term <span class="ltx_Math" id="SS1.SSS1.p14.m2">u(t)</span> and <span class="ltx_Math" id="SS1.SSS1.p14.m3">\nabla_{\!\!x}\phi_{k}\big(x(t)\big)\in\mathbb{R}</span>, the gradient of <span class="ltx_Math" id="SS1.SSS1.p14.m4">\phi_{k}\big(x(t)\big)</span> with respect to <span class="ltx_Math" id="SS1.SSS1.p14.m5">x(t)</span>.
Solving the constrained objective in (<a class="ltx_ref" href="#S10-eq:E164" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">164</span></a>) then results in the analytical solution (see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib20" title="Spectral multiscale coverage: a uniform coverage algorithm for mobile sensor networks">10</a>]</cite> for the complete derivation)</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:Ex118">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="Ex118.m1">u(t)=\tilde{u}(t)\frac{u^{\max}}{\|\tilde{u}(t)\|}=\text{sign}\big(u(t)\big)u^{\max},\quad\mathrm{with}\quad\tilde{u}(t)=-\sum_{k=0}^{K-1}\Lambda_{k}\big(w_{k}-\hat{w}_{k}\big)\nabla_{\!\!x}\phi_{k}\big(x(t)\big)\\
</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p15">
<p class="ltx_p">It is important to emphasize that the implementation of this controller does not rely on any random number generation: this search behavior is instead deterministic.

<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S10-para:SS1.SSS1.p16">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Computation in vector form</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S10-para:SS1.SSS1.p17">
<p class="ltx_p">The superposition of basis functions in (<a class="ltx_ref" href="#S10-eq:E128" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">128</span></a>) can be rewritten as</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E140">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E140.m1">g(x)=\bm{w}^{\scriptscriptstyle\top}\bm{\phi}(x),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(140)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS1.p17.m1">\bm{w}</span> and <span class="ltx_Math" id="SS1.SSS1.p17.m2">\bm{\phi}(x)</span> are vectors formed with the <span class="ltx_Math" id="SS1.SSS1.p17.m3">K</span> elements of <span class="ltx_Math" id="SS1.SSS1.p17.m4">w_{k}</span> and <span class="ltx_Math" id="SS1.SSS1.p17.m5">\phi_{k}(x)</span>, respectively.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p18">
<p class="ltx_p">The goal of ergodic control in (<a class="ltx_ref" href="#S10-eq:E136" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">136</span></a>) is to minimize</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E141">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E141.m1">\epsilon=\frac{1}{2}{\Big(\bm{w}-\bm{\hat{w}}\Big)}^{\!{\scriptscriptstyle\top}}\bm{\Lambda}\,\Big(\bm{w}-\bm{\hat{w}}\Big),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(141)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS1.p18.m1">\bm{\hat{w}}</span> is a vector formed with the <span class="ltx_Math" id="SS1.SSS1.p18.m2">K</span> elements <span class="ltx_Math" id="SS1.SSS1.p18.m3">\hat{w}_{k}</span>, and <span class="ltx_Math" id="SS1.SSS1.p18.m4">\bm{\Lambda}</span> is a weighting matrix formed with the <span class="ltx_Math" id="SS1.SSS1.p18.m5">K</span> diagonal elements <span class="ltx_Math" id="SS1.SSS1.p18.m6">\Lambda_{k}</span>.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p19">
<p class="ltx_p">By defining <span class="ltx_Math" id="SS1.SSS1.p19.m1">\bm{\phi}(x_{s})</span> as the vector concatenating the <span class="ltx_Math" id="SS1.SSS1.p19.m2">K</span> elements <span class="ltx_Math" id="SS1.SSS1.p19.m3">\phi_{k}(x_{s})</span>, (<a class="ltx_ref" href="#S10-eq:E134" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">134</span></a>) can be rewritten in a vector form as</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E142">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E142.m1">\bm{w}=\frac{1}{T}\sum_{s=1}^{T}\bm{\phi}(x_{s}).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(142)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p20">
<p class="ltx_p">With some abuse of notation, by defining a vector <span class="ltx_Math" id="SS1.SSS1.p20.m1">\bm{\tilde{v}}={[0,\ldots,K\!-\!1]}^{\scriptscriptstyle\top}</span>, we can conveniently compute</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx45">
<tbody id="S10-eq:E143"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E143.m1">\displaystyle\bm{\phi}(x)</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E143.m2">\displaystyle=\frac{1}{L}\cos(\bm{v}x),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(143)</span></td>
</tr></tbody>
<tbody id="S10-eq:E144"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E144.m1">\displaystyle\nabla_{\!\!x}\bm{\phi}(x)</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E144.m2">\displaystyle=-\frac{\bm{v}}{L}\sin(\bm{v}x),\quad\text{with}\quad\bm{v}=\frac{2\pi\bm{\tilde{v}}}{L},</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(144)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS1.p20.m2">\bm{\nabla}_{\!\!x}\bm{\phi}(x)</span> is a vector formed by the <span class="ltx_Math" id="SS1.SSS1.p20.m3">K</span> elements <span class="ltx_Math" id="SS1.SSS1.p20.m4">\nabla_{\!\!x}\phi_{k}(x)</span>, yielding the controller</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E145">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E145.m1">u(t)=-{\bm{\nabla}_{\!\!x}\bm{\phi}(x)}^{\scriptscriptstyle\top}\;\bm{\Lambda}\,\big(\bm{w}-\bm{\hat{w}}\big).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(145)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p21">
<p class="ltx_p">Figure <a class="ltx_ref" href="#S10-fig:F39" title="Figure 39 ‣ 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">39</span></a> shows how this controller can be interpreted in the spatial domain.</p>
</div>
<div class="ltx_para ltx_noindent" id="S10-para:SS1.SSS1.p22">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Planning formulation of unidimensional SMC with iLQR</span></p>
</div>
<figure class="ltx_figure figure_main" id="S10-fig:F40"><a href="online_course/images/ergodicControl_DDP_1D01.png" target="_blank"><img class="ltx_graphics ltx_centering ltx_img_landscape" id="F40.g1" src="online_course/images/small/ergodicControl_DDP_1D01.png"/></a>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 40</span>: </span><span class="ltx_text">Unidimensional SMC problem computed with iLQR. A series of control commands is used as initial guess (see timeline plot in gray on the bottom-left), which is then iteratively refined by iLQR (see timeline plot in black on the bottom-left). The top plots shows the reference distribution (in red) and the reconstructed distributions (in gray for initial guess and black after iLQR), in both spatial domain (top-left) and spectral domain (top-right).

</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S10-para:SS1.SSS1.p23">
<p class="ltx_p">By exploiting the results of Section <a class="ltx_ref" href="#S9" title="9 iLQR with quadratic cost on f(x) ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">9</span></a>, the batch formulation of iLQR consists of minimizing the cost</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E146">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E146.m1">c(\bm{x},\bm{u})=\bm{f}(\bm{x})^{\!{\scriptscriptstyle\top}}\bm{Q}\bm{f}(\bm{x})+\bm{u}^{\scriptscriptstyle\top}\bm{R}\,\bm{u},</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(146)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with <span class="ltx_Math" id="SS1.SSS1.p23.m1">\bm{Q}=\bm{\Lambda}</span> and <span class="ltx_Math" id="SS1.SSS1.p23.m2">\bm{f}(\bm{x})=\bm{w}(\bm{x})-\bm{\hat{w}}</span>, with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E147">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E147.m1">\bm{w}(\bm{x})=\frac{1}{T}\sum_{s=1}^{T}\bm{\phi}(\bm{x}_{s}),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(147)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p24">
<p class="ltx_p">By starting from an initial guess, the iterative updates of (<a class="ltx_ref" href="#S10-eq:E146" title="In 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">146</span></a>) are given by</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E148">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E148.m1">\Delta\bm{\hat{u}}\!=\!{\Big(\bm{S}_{\bm{u}}^{\scriptscriptstyle\top}\bm{J}(\bm{x})^{\scriptscriptstyle\top}\bm{Q}\bm{J}(\bm{x})\bm{S}_{\bm{u}}\!+\!\bm{R}\Big)}^{\!\!-1}\Big(-\bm{S}_{\bm{u}}^{\scriptscriptstyle\top}\bm{J}(\bm{x})^{\scriptscriptstyle\top}\bm{Q}\bm{f}(\bm{x})-\bm{R}\,\bm{u}\Big),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(148)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with <span class="ltx_Math" id="SS1.SSS1.p24.m1">\bm{J}(\bm{x})=\frac{\partial\bm{f}(\bm{x})}{\partial\bm{x}}</span> a Jacobian matrix given by</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E149">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E149.m1">\bm{J}(\bm{x})=\frac{1}{T}\begin{bmatrix}\nabla_{\!\!x}\bm{\phi}(x_{1}),\nabla_{\!\!x}\bm{\phi}(x_{2}),\ldots\nabla_{\!\!x}\bm{\phi}(x_{T})\end{bmatrix}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(149)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS1.p25">
<p class="ltx_p">Figure <a class="ltx_ref" href="#S10-fig:F40" title="Figure 40 ‣ 10.1.1 Unidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">40</span></a> presents the output of the accompanying source codes.</p>
</div>
</div>
<div class="ltx_subsubsection" id="S10-sec:SS1.SSS2">
<h3 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text">10.1.2</span> </span><span class="ltx_text">Multidimensional SMC</span>
</h3>
<figure class="ltx_figure figure_main" id="S10-fig:F41"><a href="online_course/images/basisFcts2D01.png" target="_blank"><img class="ltx_graphics ltx_centering ltx_img_landscape" id="F41.g1" src="online_course/images/small/basisFcts2D01.png"/></a>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 41</span>: </span><span class="ltx_text">Decomposition of the spatial distribution using Fourier basis functions.

</span></figcaption>
</figure>
<figure class="ltx_figure figure_main" id="S10-fig:F42"><a href="online_course/images/ergodicControl02.png" target="_blank"><img class="ltx_graphics ltx_centering ltx_img_square" id="F42.g1" src="online_course/images/small/ergodicControl02.png"/></a>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 42</span>: </span><span class="ltx_text">2D ergodic control based on SMC used to generate search behaviors.
<em class="ltx_emph ltx_font_italic">(a)</em> shows the spatial distribution <span class="ltx_Math" id="F42.m16">\hat{g}(\bm{x})</span> that the agent has to explore, encoded here as a mixture of two Gaussians (gray colormap in left graph). The right graphs show the corresponding Fourier series coefficients <span class="ltx_Math" id="F42.m17">\hat{w}_{\bm{k}}</span> in the frequency domain (<span class="ltx_Math" id="F42.m18">K=9</span> coefficients per dimension). <em class="ltx_emph ltx_font_italic">(b)</em> shows the evolution of the reconstructed spatial distribution <span class="ltx_Math" id="F42.m19">g(\bm{x})</span> (left graph) and the computation of the next control command <span class="ltx_Math" id="F42.m20">\bm{u}</span> (red arrow) after <span class="ltx_Math" id="F42.m21">T/10</span> iterations. The corresponding Fourier series coefficients <span class="ltx_Math" id="F42.m22">w_{\bm{k}}</span> are shown in the right graph. <em class="ltx_emph ltx_font_italic">(c)</em> shows that after <span class="ltx_Math" id="F42.m23">T</span> iterations, the agent covers the space in proportion to the desired spatial distribution, with a good match of coefficients in the frequency domain (we can see that <span class="ltx_Math" id="F42.m24">\hat{w}_{\bm{k}}</span> and <span class="ltx_Math" id="F42.m25">w_{\bm{k}}</span> are nearly the same). <em class="ltx_emph ltx_font_italic">(d)</em> shows how a periodic signal <span class="ltx_Math" id="F42.m26">\hat{g}(\bm{x})</span> (with range <span class="ltx_Math" id="F42.m27">[-L/2,L/2]</span> for each dimension) can be constructed from an initial mixture of two Gaussians <span class="ltx_Math" id="F42.m28">\hat{g}_{0}(\bm{x})</span> (red area). The constructed signal <span class="ltx_Math" id="F42.m29">\hat{g}(\bm{x})</span> is composed of eight Gaussians in this 2D example, by mirroring the Gaussians along horizontal and vertical axes to construct an even signal of period <span class="ltx_Math" id="F42.m30">L</span>. <em class="ltx_emph ltx_font_italic">(e)</em> depicts the first few basis functions of the Fourier series for the first four coefficients in each dimension, represented as a 2D colormap corresponding to periodic signals of different frequencies along two axes.

</span></figcaption>
</figure>
<figure class="ltx_figure figure_main" id="S10-fig:F43"><a href="online_course/images/ergodicControl_DDP_2D01.png" target="_blank"><img class="ltx_graphics ltx_centering ltx_img_landscape" id="F43.g1" src="online_course/images/small/ergodicControl_DDP_2D01.png"/></a>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text">Figure 43</span>: </span><span class="ltx_text">Bidimensional SMC problem computed with iLQR.

</span></figcaption>
</figure>
<div class="ltx_para" id="S10-para:SS1.SSS2.p1">
<p class="ltx_p">For the multidimensional case, we will define <span class="ltx_Math" id="SS1.SSS2.p1.m1">\mathcal{K}</span> as a set of index vectors covering a <span class="ltx_Math" id="SS1.SSS2.p1.m2">D</span>-dimensional array <span class="ltx_Math" id="SS1.SSS2.p1.m3">\bm{k}=\bm{r}\times\bm{r}\times\cdots\times\bm{r}</span>, with <span class="ltx_Math" id="SS1.SSS2.p1.m4">\bm{r}=[0,1,\ldots,K\!-\!1]</span> and <span class="ltx_Math" id="SS1.SSS2.p1.m5">K</span> the resolution of the array. For example, with <span class="ltx_Math" id="SS1.SSS2.p1.m6">D=2</span> and <span class="ltx_Math" id="SS1.SSS2.p1.m7">K=2</span>, we will have <span class="ltx_Math" id="SS1.SSS2.p1.m8">\mathcal{K}=\big\{\left[\begin{smallmatrix}0\\
0\end{smallmatrix}\right],\left[\begin{smallmatrix}0\\
1\end{smallmatrix}\right],\left[\begin{smallmatrix}1\\
0\end{smallmatrix}\right],\left[\begin{smallmatrix}1\\
1\end{smallmatrix}\right]\big\}</span>.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p2">
<p class="ltx_p">Similarly as the unidimensional case, we will build a controller so that the Fourier series coefficients <span class="ltx_Math" id="SS1.SSS2.p2.m1">w_{\bm{k}}</span> along a trajectory <span class="ltx_Math" id="SS1.SSS2.p2.m2">\bm{x}(t)</span> of duration <span class="ltx_Math" id="SS1.SSS2.p2.m3">t</span>, defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E150">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E150.m1">w_{\bm{k}}=\frac{1}{t}\int_{\tau=0}^{t}\phi_{\bm{k}}\big(\bm{x}(\tau)\big)\;d\tau,</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(150)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">will match the Fourier series coefficients <span class="ltx_Math" id="SS1.SSS2.p2.m4">\hat{w}_{\bm{k}}</span> on the spatial domain <span class="ltx_Math" id="SS1.SSS2.p2.m5">\mathcal{X}</span>, defined as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx46">
<tbody id="S10-eq:E151"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E151.m1">\displaystyle\hat{w}_{\bm{k}}</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E151.m2">\displaystyle=\int_{\bm{x}\in\mathcal{X}}\hat{g}(\bm{x})\;\phi_{\bm{k}}(\bm{x})\;\text{d}\bm{x}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(151)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p3">
<p class="ltx_p">The discretized version of (<a class="ltx_ref" href="#S10-eq:E150" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">150</span></a>) for a discrete number of time steps <span class="ltx_Math" id="SS1.SSS2.p3.m1">T</span> is</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E152">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E152.m1">w_{\bm{k}}=\frac{1}{T}\sum_{s=1}^{T}\phi_{\bm{k}}(\bm{x}_{s}),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(152)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">or equivalently in vector form <span class="ltx_Math" id="SS1.SSS2.p3.m2">\bm{w}=\frac{1}{T}\sum_{s=1}^{T}\bm{\phi}(\bm{x}_{s})</span>, which can be computed recursively by updating <span class="ltx_Math" id="SS1.SSS2.p3.m3">\bm{w}</span> at each iteration step.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p4">
<p class="ltx_p">Similarly, the discretized version of (<a class="ltx_ref" href="#S10-eq:E151" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">151</span></a>) for a given spatial resolution can for example be computed on a domain <span class="ltx_Math" id="SS1.SSS2.p4.m1">[0,1]</span> discretized in <span class="ltx_Math" id="SS1.SSS2.p4.m2">X</span> bins for each dimension as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx47">
<tbody id="S10-eq:E153"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E153.m1">\displaystyle\hat{w}_{\bm{k}}</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E153.m2">\displaystyle=\sum_{s_{1}=1}^{X}\sum_{s_{2}=1}^{X}\cdots\sum_{s_{d}=0}^{X}\hat{g}(\bm{x}_{\bm{s}})\;\phi_{\bm{k}}(\bm{x}_{\bm{s}}),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(153)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where each dimension <span class="ltx_Math" id="SS1.SSS2.p4.m3">i</span> of <span class="ltx_Math" id="SS1.SSS2.p4.m4">\bm{x}</span> is given by index <span class="ltx_Math" id="SS1.SSS2.p4.m5">s_{i}</span> splitting each domain dimension into <span class="ltx_Math" id="SS1.SSS2.p4.m6">X</span> equal bins.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p5">
<p class="ltx_p">The goal of ergodic control is to minimize</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx48">
<tbody id="S10-eq:E154"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E154.m1">\displaystyle\epsilon</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E154.m2">\displaystyle=\frac{1}{2}\sum_{{\bm{k}}\in\mathcal{K}}\Lambda_{\bm{k}}\Big(w_{\bm{k}}-\hat{w}_{\bm{k}}\Big)^{\!2}</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(154)</span></td>
</tr></tbody>
<tbody id="S10-eq:E155"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E155.m1">\displaystyle=\frac{1}{2}{\Big(\bm{w}-\bm{\hat{w}}\Big)}^{\!{\scriptscriptstyle\top}}\bm{\Lambda}\,\Big(\bm{w}-\bm{\hat{w}}\Big),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(155)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS2.p5.m1">\Lambda_{\bm{k}}</span> are weights, <span class="ltx_Math" id="SS1.SSS2.p5.m2">\hat{w}_{\bm{k}}</span> are the Fourier series coefficients of <span class="ltx_Math" id="SS1.SSS2.p5.m3">\hat{g}(\bm{x})</span>, and <span class="ltx_Math" id="SS1.SSS2.p5.m4">w_{\bm{k}}</span> are the Fourier series coefficients along the trajectory <span class="ltx_Math" id="SS1.SSS2.p5.m5">\bm{x}(t)</span>.
<span class="ltx_Math" id="SS1.SSS2.p5.m6">\bm{w}\in\mathbb{R}^{K^{D}}</span> and <span class="ltx_Math" id="SS1.SSS2.p5.m7">\bm{\hat{w}}\in\mathbb{R}^{K^{D}}</span> are vectors composed of elements <span class="ltx_Math" id="SS1.SSS2.p5.m8">w_{\bm{k}}</span> and <span class="ltx_Math" id="SS1.SSS2.p5.m9">\hat{w}_{\bm{k}}</span>, respectively. <span class="ltx_Math" id="SS1.SSS2.p5.m10">\bm{\Lambda}\in\mathbb{R}^{K^{D}\times K^{D}}</span> is a diagonal weighting matrix with elements <span class="ltx_Math" id="SS1.SSS2.p5.m11">\Lambda_{\bm{k}}</span>.
In (<a class="ltx_ref" href="#S10-eq:E154" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">154</span></a>), the weights</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E156">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E156.m1">\Lambda_{\bm{k}}=\left(1+\|\bm{k}\|^{2}\right)^{\!-\frac{D+1}{2}}</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(156)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">assign more importance on matching low frequency components (related to a metric for Sobolev spaces of negative order).</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p6">
<p class="ltx_p">Practically, the controller will mainly focus on the lowest frequency components at the beginning as these components have a large effect on the cost due to the large weights. When the errors become zero for these components, the controller can then try to progressively reduce higher frequency components.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p7">
<p class="ltx_p">For a spatial signal <span class="ltx_Math" id="SS1.SSS2.p7.m1">\bm{x}\in\mathbb{R}^{D}</span>, where <span class="ltx_Math" id="SS1.SSS2.p7.m2">x_{d}</span> is on the interval <span class="ltx_Math" id="SS1.SSS2.p7.m3">[-\frac{L}{2},\frac{L}{2}]</span> of period <span class="ltx_Math" id="SS1.SSS2.p7.m4">L</span>, <span class="ltx_Math" id="SS1.SSS2.p7.m5">\forall d\!\in\!\{1,\ldots,D\}</span>, the basis functions of the Fourier series with complex exponential functions are defined as (see Fig. <a class="ltx_ref" href="#S10-fig:F42" title="Figure 42 ‣ 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">42</span></a>-<em class="ltx_emph ltx_font_italic">(e)</em>)</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E157">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E157.m1">\phi_{\bm{k}}(\bm{x})=\frac{1}{L^{D}}\prod_{d=1}^{D}\cos\!\left(\frac{2\pi k_{d}x_{d}}{L}\right),\quad\forall\bm{k}\!\in\!\mathcal{K}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(157)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p8">
<p class="ltx_p">By concatenating the <span class="ltx_Math" id="SS1.SSS2.p8.m1">K^{D}</span> index vectors <span class="ltx_Math" id="SS1.SSS2.p8.m2">\bm{k}\!\in\!\mathcal{K}</span> into a matrix <span class="ltx_Math" id="SS1.SSS2.p8.m3">\bm{\tilde{V}}\in\mathbb{R}^{D\times K^{D}}</span>, we can conveniently compute <span class="ltx_Math" id="SS1.SSS2.p8.m4">\bm{\phi}(\bm{x})</span> as the vector concatenating all <span class="ltx_Math" id="SS1.SSS2.p8.m5">K^{D}</span> elements <span class="ltx_Math" id="SS1.SSS2.p8.m6">\phi_{\bm{k}}(\bm{x}),\,\forall\bm{k}\!\in\!\mathcal{K}</span>, namely</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx49">
<tbody id="S10-eq:E158"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E158.m1">\displaystyle\bm{\phi}(\bm{x})</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E158.m2">\displaystyle=\frac{1}{L^{D}}\bigodot_{d=1}^{D}\cos(\bm{V}_{d}x_{d})</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(158)</span></td>
</tr></tbody>
<tbody id="S10-eq:E159"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E159.m1">\displaystyle=\frac{1}{L^{D}}\cos(\bm{V}_{1}x_{1})\odot\cos(\bm{V}_{2}x_{2})\odot\cdots\odot\cos(\bm{V}_{D}x_{D}),\quad\text{with}\quad\bm{V}=\frac{2\pi\bm{\tilde{V}}}{L},</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(159)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS1.SSS2.p8.m7">\odot</span> the elementwise/Hadamard product operator.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p9">
<p class="ltx_p">The derivatives of the vector <span class="ltx_Math" id="SS1.SSS2.p9.m1">\bm{\phi}(\bm{x})</span> with respect to <span class="ltx_Math" id="SS1.SSS2.p9.m2">\bm{x}</span> are given by the matrix <span class="ltx_Math" id="SS1.SSS2.p9.m3">\nabla_{\!\!\bm{x}}\bm{\phi}(\bm{x})</span> of size <span class="ltx_Math" id="SS1.SSS2.p9.m4">K^{D}\times D</span> by concatenating horizontally the <span class="ltx_Math" id="SS1.SSS2.p9.m5">D</span> vectors</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx50">
<tbody id="S10-eq:E160"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E160.m1">\displaystyle\nabla_{\!\!\bm{x}}\bm{\phi}_{d}(\bm{x})</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E160.m2">\displaystyle=-\frac{1}{L^{D}}\,\bm{V}_{d}\odot\sin(\bm{V}_{d}x_{d})\bigodot_{i\neq d}\cos(\bm{V}_{i}x_{i})</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(160)</span></td>
</tr></tbody>
<tbody id="S10-eq:E161"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E161.m1">\displaystyle=-\frac{1}{L^{D}}\,\bm{V}_{d}\odot\cos(\bm{V}_{1}x_{1})\odot\cdots\odot\cos(\bm{V}_{d-1}x_{d-1})\odot\sin(\bm{V}_{d}x_{d})\odot\cos(\bm{V}_{d+1}x_{d+1})\odot\cdots\odot\cos(\bm{V}_{D}x_{D}).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(161)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p10">
<p class="ltx_p">For the specific example of a 2D space, (<a class="ltx_ref" href="#S10-eq:E159" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">159</span></a>) and (<a class="ltx_ref" href="#S10-eq:E161" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">161</span></a>) yield</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S10-eq:A5.EGx51">
<tbody id="S10-eq:E162"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E162.m1">\displaystyle\bm{\phi}(\bm{x})</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E162.m2">\displaystyle=\frac{1}{L^{2}}\cos(\bm{V}_{1}x_{1})\odot\cos(\bm{V}_{2}x_{2}),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(162)</span></td>
</tr></tbody>
<tbody id="S10-eq:E163"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_Math" id="E163.m1">\displaystyle\nabla_{\!\!\bm{x}}\bm{\phi}(\bm{x})</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_Math" id="E163.m2">\displaystyle=\begin{bmatrix}-\frac{1}{L}\,\bm{V}_{1}\odot\sin(\bm{V}_{1}x_{1})\odot\cos(\bm{V}_{2}x_{2})&amp;-\frac{1}{L}\,\bm{V}_{2}\odot\cos(\bm{V}_{1}x_{1})\odot\sin(\bm{V}_{2}x_{2})\end{bmatrix}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(163)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p11">
<p class="ltx_p">Ergodic control is set as the constrained problem of computing a control command <span class="ltx_Math" id="SS1.SSS2.p11.m1">\bm{\hat{u}}(t)</span> at each time step <span class="ltx_Math" id="SS1.SSS2.p11.m2">t</span> with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E164">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E164.m1">\bm{\hat{u}}(t)=\arg\min_{\bm{u}(t)}\;\epsilon\big(\bm{x}(t\!+\!\Delta t)\big),\quad\text{s.t.}\quad\bm{\dot{x}}(t)=f\big(\bm{x}(t),\bm{u}(t)\big),\quad\|\bm{u}(t)\|\leqslant u^{\max},</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(164)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the simple system <span class="ltx_Math" id="SS1.SSS2.p11.m3">\bm{u}(t)=\bm{\dot{x}}(t)</span> is considered (control with velocity commands), and where the error term is approximated with the Taylor series</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E165">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E165.m1">\epsilon\big(\bm{x}(t\!+\!\Delta t)\big)\;\approx\;\epsilon\big(\bm{x}(t)\big)\;+\;\dot{\epsilon}\big(\bm{x}(t)\big)\Delta t\;+\;\frac{1}{2}\ddot{\epsilon}\big(\bm{x}(t)\big){\Delta t}^{2}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(165)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p12">
<p class="ltx_p">By using (<a class="ltx_ref" href="#S10-eq:E154" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">154</span></a>), (<a class="ltx_ref" href="#S10-eq:E150" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">150</span></a>), (<a class="ltx_ref" href="#S10-eq:E157" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">157</span></a>) and the chain rule <span class="ltx_Math" id="SS1.SSS2.p12.m1">\frac{\partial f}{\partial t}=\frac{\partial f}{\partial\bm{x}}\frac{\partial\bm{x}}{\partial t}</span>, the Taylor series
is composed of the control term <span class="ltx_Math" id="SS1.SSS2.p12.m2">\bm{u}(t)</span> and <span class="ltx_Math" id="SS1.SSS2.p12.m3">\nabla_{\!\!\bm{x}}\phi_{\bm{k}}\big(\bm{x}(t)\big)\in\mathbb{R}^{1\times D}</span>, the gradient of <span class="ltx_Math" id="SS1.SSS2.p12.m4">\phi_{\bm{k}}\big(\bm{x}(t)\big)</span> with respect to <span class="ltx_Math" id="SS1.SSS2.p12.m5">\bm{x}(t)</span>.
Solving the constrained objective in (<a class="ltx_ref" href="#S10-eq:E164" title="In 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">164</span></a>) then results in the analytical solution (see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib20" title="Spectral multiscale coverage: a uniform coverage algorithm for mobile sensor networks">10</a>]</cite> for the complete derivation)</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E166">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E166.m1">\bm{u}(t)=\bm{\tilde{u}}(t)\frac{u^{\max}}{\|\bm{\tilde{u}}(t)\|},\quad\mathrm{with}\quad\bm{\tilde{u}}(t)=-{\nabla_{\!\!\bm{x}}\bm{\phi}(\bm{x})}^{\scriptscriptstyle\top}\,\bm{\Lambda}\,\big(\bm{w}-\bm{\hat{w}}\big).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(166)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p13">
<p class="ltx_p">Figures <a class="ltx_ref" href="#S10-fig:F41" title="Figure 41 ‣ 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">41</span></a> and <a class="ltx_ref" href="#S10-fig:F42" title="Figure 42 ‣ 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">42</span></a> show a 2D example of ergodic control to create a motion approximating the distribution given by a mixture of two Gaussians. A remarkable characteristic of such approach is that the controller produces natural exploration behaviors without relying on stochastic noise in the formulation, see Fig. <a class="ltx_ref" href="#S10-fig:F42" title="Figure 42 ‣ 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">42</span></a>-<em class="ltx_emph ltx_font_italic">(c)</em>. In the limit case, if the distribution <span class="ltx_Math" id="SS1.SSS2.p13.m1">g(\bm{x})</span> is a single Gaussian with a very small isotropic covariance, the controller results in a conventional target reaching behavior.</p>
</div>
<div class="ltx_para" id="S10-para:SS1.SSS2.p14">
<p class="ltx_p">Figure <a class="ltx_ref" href="#S10-fig:F43" title="Figure 43 ‣ 10.1.2 Multidimensional SMC ‣ 10.1 Spectral-based ergodic control (SMC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">43</span></a> presents the output of the accompanying source codes, where the initial guess is computed by standard SMC (myopic), whose resulting control command trajectory is then refined with iLQR (SMC as a planning problem).</p>
</div>
</div>
</div><div class="ltx_subsection" id="S10-sec:SS2">
<h2 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text">10.2</span> </span><span class="ltx_text">Diffusion-based ergodic control (HEDAC)</span>
</h2>
<div class="ltx_para" id="S10-para:SS2.p1">
<p class="ltx_p">Heat equation driven area coverage (HEDAC) is another area coverage method that relies on diffusion processes instead of spectral analysis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib-bib:bib21" title="Ergodicity-based cooperative multiagent area coverage via a potential field">6</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S10-para:SS2.p2">
<p class="ltx_p">The coverage density currently covered by the agent(s) is defined as the convolution of an instantaneous action and the trajectory, which results in a field occupying the space around the path of the agent. A radial basis function can for example be used as the instantaneous action.</p>
</div>
<div class="ltx_para" id="S10-para:SS2.p3">
<p class="ltx_p">The algorithm designs a potential field based on the heat equation by using a source term constructed as the difference between the given goal density and the current coverage density. The movements of the agent(s) are directed by the gradient of this potential field, leading them to the area of interest and producing paths to achieve the desired coverage density. The diffusion of the heat allows the agent(s) to get access to this gradient, bringing them to the regions of the target coverage density that have not been explored yet.</p>
</div>
<div class="ltx_para" id="S10-para:SS2.p4">
<p class="ltx_p">HEDAC considers a target distribution <span class="ltx_Math" id="SS2.p4.m1">p(\bm{x})</span> to be covered, and the time-dependent coverage <span class="ltx_Math" id="SS2.p4.m2">c(\bm{x},t)</span> that one or multiple moving agents have already covered. The coverage residual <span class="ltx_Math" id="SS2.p4.m3">e(\bm{x},t)</span> is defined as the scalar field</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E167">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E167.m1">e(\bm{x},t)=p(\bm{x})-c(\bm{x},t),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(167)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which is used to build a virtual heat source with nonnegative values</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E168">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E168.m1">\tilde{s}(\bm{x},t)=\max\left(e(\bm{x},t),0\right)^{2}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(168)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS2.p5">
<p class="ltx_p">For proper scaling, the heat source is further normalized over the domain using</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E169">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E169.m1">s(\bm{x},t)=\frac{\tilde{s}(\bm{x},t)}{\int_{\Omega}\tilde{s}(\bm{x},t)dx}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(169)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS2.p6">
<p class="ltx_p">The heat source is then diffused over the domain to propagate the information about the unexplored regions to the agent(s). For that purpose, we use the heat equation: a second-order partial differential equation (PDE) that models heat conduction by relating spatial and time derivatives of a scalar field with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E170">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E170.m1">\frac{\partial u(\bm{x},t)}{\partial t}=\alpha\Delta u(\bm{x},t)+s(\bm{x},t),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(170)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS2.p6.m1">u(\bm{x},t)</span> corresponds to the temperature field, <span class="ltx_Math" id="SS2.p6.m2">\alpha</span> is a thermal diffusivity parameter, and <span class="ltx_Math" id="SS2.p6.m3">\Delta u=\frac{\partial^{2}u}{\partial x_{1}^{2}}+\frac{\partial^{2}u}{\partial x_{2}^{2}}+\ldots</span> is the Laplacian of the function <span class="ltx_Math" id="SS2.p6.m4">u</span>.</p>
</div>
<div class="ltx_para" id="S10-para:SS2.p7">
<p class="ltx_p">In order to control the agents, the potential field exerts a fictitious force on each of the <span class="ltx_Math" id="SS2.p7.m1">i</span>-th agent, based on the gradient of the temperature field</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E171">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E171.m1">\bm{f}_{i}=\bm{\nabla}u(\bm{x}_{i},t).</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(171)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS2.p8">
<p class="ltx_p">Neumann boundary conditions can be imposed (corresponding to thermal insulation), which means that information propagation stays within the domain boundary with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E172">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E172.m1">\frac{\partial u}{\partial\textbf{n}}=0,\quad\text{on}\quad\partial\Omega,</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(172)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS2.p8.m1">\Omega</span> is a <span class="ltx_Math" id="SS2.p8.m2">n</span>-dimensional domain with Lipschitz continuous boundary.</p>
</div>
<div class="ltx_para" id="S10-para:SS2.p9">
<p class="ltx_p">At each iteration step of the algorithm, we compute the coverage of the agent(s), which cool the temperature field and mark the regions they cover by updating the coverage distribution <span class="ltx_Math" id="SS2.p9.m1">c_{i}(\bm{x},t)</span>. For the <span class="ltx_Math" id="SS2.p9.m2">i</span>-th agent, the coverage is computed by the relation</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E173">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E173.m1">c_{i}(\bm{x},t)=\int_{0}^{t}\phi(\bm{x}-\bm{x}_{i}(\tau))d\tau,</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(173)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <span class="ltx_Math" id="SS2.p9.m3">\phi(\bm{x}_{i})</span> is the footprint or shape of the virtual agent (arbitrary shape). For example, a Gaussian radial basis functions (RBF) with adjustable shape parameter <span class="ltx_Math" id="SS2.p9.m4">\epsilon</span> can be used, given by</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E174">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E174.m1">\phi(\bm{x})=e^{-\left(\epsilon\bm{x}\right)^{2}}.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(174)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S10-para:SS2.p10">
<p class="ltx_p">The total coverage containing the exploration effort of all the agents is then computed with</p>
<table class="ltx_equation ltx_eqn_table" id="S10-eq:E175">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><span class="ltx_Math" id="E175.m1">\tilde{c}(\bm{x},t)=\frac{1}{Nt}\sum_{i=1}^{N}c_{i}(\bm{x},t),</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(175)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">that is further normalized over the domain using (<a class="ltx_ref" href="#S10-eq:E169" title="In 10.2 Diffusion-based ergodic control (HEDAC) ‣ 10 Ergodic control ‣ A Math Cookbook for Robot Manipulation"><span class="ltx_text ltx_ref_tag">169</span></a>) to provide <span class="ltx_Math" id="SS2.p10.m1">c(\bm{x},t)</span>.</p>
</div>
</div><ul class="pagination justify-content-center small_menu"><li class="page-item previous_file"><a class="page-link" href="#S9">Previous</a></li><li class="page-item next_file"><a class="page-link" href="#S11">Next</a></li></ul></div></div><div class="col-sm-3"><div id="img-col"></div></div></div>